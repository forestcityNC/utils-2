!function(){var n=window.console||{error:function(){},warn:function(){}};function e(o){o.Control.Loading=o.Control.extend({options:{delayIndicator:null,position:"topleft",separate:!1,zoomControl:null,spinjs:!1,spin:{lines:7,length:3,width:3,radius:5,rotate:13,top:"83%"}},initialize:function(t){o.setOptions(this,t),this._dataLoaders={},null!==this.options.zoomControl&&(this.zoomControl=this.options.zoomControl)},onAdd:function(t){if(this.options.spinjs&&"function"!=typeof Spinner)return n.error("Leaflet.loading cannot load because you didn't load spin.js (http://fgnass.github.io/spin.js/), even though you set it in options.");this._addLayerListeners(t),this._addMapListeners(t),this.options.separate||this.zoomControl||(t.zoomControl?this.zoomControl=t.zoomControl:t.zoomsliderControl&&(this.zoomControl=t.zoomsliderControl));var e,i="leaflet-control-loading";return this.zoomControl&&!this.options.separate?(e=this.zoomControl._container,i+=" leaflet-bar-part-bottom leaflet-bar-part last",o.DomUtil.addClass(this._getLastControlButton(),"leaflet-bar-part-bottom")):e=o.DomUtil.create("div","leaflet-control-zoom leaflet-control-layer-container leaflet-bar"),this._indicatorContainer=e,this._indicator=o.DomUtil.create("a",i,e),this.options.spinjs&&(this._spinner=new Spinner(this.options.spin).spin(),this._indicator.appendChild(this._spinner.el)),e},onRemove:function(t){this._removeLayerListeners(t),this._removeMapListeners(t)},removeFrom:function(t){return this.zoomControl&&!this.options.separate?(this._container.removeChild(this._indicator),this._map=null,this.onRemove(t),this):o.Control.prototype.removeFrom.call(this,t)},addLoader:function(t){if(this._dataLoaders[t]=!0,this.options.delayIndicator&&!this.delayIndicatorTimeout){var e=this;this.delayIndicatorTimeout=setTimeout(function(){e.updateIndicator(),e.delayIndicatorTimeout=null},this.options.delayIndicator)}else this.updateIndicator()},removeLoader:function(t){delete this._dataLoaders[t],this.updateIndicator(),this.options.delayIndicator&&this.delayIndicatorTimeout&&!this.isLoading()&&(clearTimeout(this.delayIndicatorTimeout),this.delayIndicatorTimeout=null)},updateIndicator:function(){this.isLoading()?this._showIndicator():this._hideIndicator()},isLoading:function(){return 0<this._countLoaders()},_countLoaders:function(){var t,e=0;for(t in this._dataLoaders)this._dataLoaders.hasOwnProperty(t)&&e++;return e},_showIndicator:function(){o.DomUtil.addClass(this._indicator,"is-loading"),o.DomUtil.addClass(this._indicatorContainer,"is-loading"),this.options.separate||(this.zoomControl instanceof o.Control.Zoom?o.DomUtil.removeClass(this._getLastControlButton(),"leaflet-bar-part-bottom"):"function"==typeof o.Control.Zoomslider&&this.zoomControl instanceof o.Control.Zoomslider&&o.DomUtil.removeClass(this.zoomControl._ui.zoomOut,"leaflet-bar-part-bottom"))},_hideIndicator:function(){o.DomUtil.removeClass(this._indicator,"is-loading"),o.DomUtil.removeClass(this._indicatorContainer,"is-loading"),this.options.separate||(this.zoomControl instanceof o.Control.Zoom?o.DomUtil.addClass(this._getLastControlButton(),"leaflet-bar-part-bottom"):"function"==typeof o.Control.Zoomslider&&this.zoomControl instanceof o.Control.Zoomslider&&o.DomUtil.addClass(this.zoomControl._ui.zoomOut,"leaflet-bar-part-bottom"))},_getLastControlButton:function(){for(var t=this.zoomControl._container,e=t.children.length-1;0<e;){var i=t.children[e];if(this._indicator!==i&&0!==i.offsetWidth&&0!==i.offsetHeight)break;e--}return t.children[e]},_handleLoading:function(t){this.addLoader(this.getEventId(t))},_handleBaseLayerChange:function(t){var e=this;t.layer&&t.layer.eachLayer&&"function"==typeof t.layer.eachLayer?t.layer.eachLayer(function(t){e._handleBaseLayerChange({layer:t})}):o.TileLayer.Canvas&&t.layer instanceof o.TileLayer.Canvas||e._handleLoading(t)},_handleLoad:function(t){this.removeLoader(this.getEventId(t))},getEventId:function(t){return t.id?t.id:t.layer?t.layer._leaflet_id:t.target._leaflet_id},_layerAdd:function(e){if(e.layer&&e.layer.on)try{e.layer.on({loading:this._handleLoading,load:this._handleLoad},this)}catch(t){n.warn("L.Control.Loading: Tried and failed to add  event handlers to layer",e.layer),n.warn("L.Control.Loading: Full details",t)}},_layerRemove:function(e){if(e.layer&&e.layer.off)try{e.layer.off({loading:this._handleLoading,load:this._handleLoad},this)}catch(t){n.warn("L.Control.Loading: Tried and failed to remove event handlers from layer",e.layer),n.warn("L.Control.Loading: Full details",t)}},_addLayerListeners:function(t){t.eachLayer(function(t){t.on&&t.on({loading:this._handleLoading,load:this._handleLoad},this)},this),t.on("layeradd",this._layerAdd,this),t.on("layerremove",this._layerRemove,this)},_removeLayerListeners:function(t){t.eachLayer(function(t){t.off&&t.off({loading:this._handleLoading,load:this._handleLoad},this)},this),t.off("layeradd",this._layerAdd,this),t.off("layerremove",this._layerRemove,this)},_addMapListeners:function(t){t.on({baselayerchange:this._handleBaseLayerChange,dataloading:this._handleLoading,dataload:this._handleLoad,layerremove:this._handleLoad},this)},_removeMapListeners:function(t){t.off({baselayerchange:this._handleBaseLayerChange,dataloading:this._handleLoading,dataload:this._handleLoad,layerremove:this._handleLoad},this)}}),o.Map.addInitHook(function(){this.options.loadingControl&&(this.loadingControl=new o.Control.Loading,this.addControl(this.loadingControl))}),o.Control.loading=function(t){return new o.Control.Loading(t)}}"function"==typeof define&&define.amd?define(["leaflet"],function(t){e(t)}):e(L)}(),L.Control.Sidebar=L.Control.extend({includes:L.Evented?L.Evented.prototype:L.Mixin.Events,options:{closeButton:!0,position:"left",autoPan:!0},initialize:function(t,e){L.setOptions(this,e);var i=this._contentContainer=L.DomUtil.get(t);i.parentNode.removeChild(i);var o="leaflet-",n=this._container=L.DomUtil.create("div",o+"sidebar "+this.options.position);L.DomUtil.addClass(i,o+"control"),n.appendChild(i),this.options.closeButton&&((this._closeButton=L.DomUtil.create("a","close",n)).innerHTML="&times;")},addTo:function(t){var e=this._container,i=this._contentContainer;if(this.options.closeButton){var o=this._closeButton;L.DomEvent.on(o,"click",this.hide,this)}L.DomEvent.on(e,"transitionend",this._handleTransitionEvent,this).on(e,"webkitTransitionEnd",this._handleTransitionEvent,this);var n=t._controlContainer;n.insertBefore(e,n.firstChild),this._map=t;var r=L.DomEvent.stopPropagation,s=L.DomEvent._fakeStop||r;return L.DomEvent.on(i,"contextmenu",r).on(i,"click",s).on(i,"mousedown",r).on(i,"touchstart",r).on(i,"dblclick",s).on(i,"mousewheel",r).on(i,"MozMousePixelScroll",r),this},removeFrom:function(t){this.hide();var e=this._container,i=this._contentContainer;t._controlContainer.removeChild(e),this._map=null;var o=L.DomEvent.stopPropagation,n=L.DomEvent._fakeStop||o;if(L.DomEvent.off(i,"contextmenu",o).off(i,"click",n).off(i,"mousedown",o).off(i,"touchstart",o).off(i,"dblclick",n).off(i,"mousewheel",o).off(i,"MozMousePixelScroll",o),L.DomEvent.off(e,"transitionend",this._handleTransitionEvent,this).off(e,"webkitTransitionEnd",this._handleTransitionEvent,this),this._closeButton&&this._close){var r=this._closeButton;L.DomEvent.off(r,"click",this.hide,this)}return this},isVisible:function(){return L.DomUtil.hasClass(this._container,"visible")},show:function(){this.isVisible()||(L.DomUtil.addClass(this._container,"visible"),this.options.autoPan&&this._map.panBy([-this.getOffset()/2,0],{duration:.5}),this.fire("show"))},hide:function(t){this.isVisible()&&(L.DomUtil.removeClass(this._container,"visible"),this.options.autoPan&&this._map.panBy([this.getOffset()/2,0],{duration:.5}),this.fire("hide")),t&&L.DomEvent.stopPropagation(t)},toggle:function(){this.isVisible()?this.hide():this.show()},getContainer:function(){return this._contentContainer},getCloseButton:function(){return this._closeButton},setContent:function(t){var e=this.getContainer();if("string"==typeof t)e.innerHTML=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(t)}return this},getOffset:function(){return"right"===this.options.position?-this._container.offsetWidth:this._container.offsetWidth},_handleTransitionEvent:function(t){"left"!=t.propertyName&&"right"!=t.propertyName||this.fire(this.isVisible()?"shown":"hidden")}}),L.control.sidebar=function(t,e){return new L.Control.Sidebar(t,e)},function r(s,a,l){function h(i,t){if(!a[i]){if(!s[i]){var e="function"==typeof require&&require;if(!t&&e)return e(i,!0);if(c)return c(i,!0);var o=new Error("Cannot find module '"+i+"'");throw o.code="MODULE_NOT_FOUND",o}var n=a[i]={exports:{}};s[i][0].call(n.exports,function(t){var e=s[i][1][t];return h(e||t)},n,n.exports,r,s,a,l)}return a[i].exports}for(var c="function"==typeof require&&require,t=0;t<l.length;t++)h(l[t]);return h}({1:[function(t,e,i){"use strict";function h(){}function o(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,t!==h&&a(this,t)}function n(t,e,i){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function r(e,i,o){c(function(){var t;try{t=i(o)}catch(t){return p.reject(e,t)}t===e?p.reject(e,new TypeError("Cannot resolve promise with itself")):p.resolve(e,t)})}function s(t){var e=t&&t.then;return t&&"object"==typeof t&&"function"==typeof e?function(){e.apply(t,arguments)}:void 0}function a(e,t){function i(t){n||(n=!0,p.reject(e,t))}function o(t){n||(n=!0,p.resolve(e,t))}var n=!1,r=l(function(){t(o,i)});"error"===r.status&&i(r.value)}function l(t,e){var i={};try{i.value=t(e),i.status="success"}catch(t){i.status="error",i.value=t}return i}var c=t("immediate"),p={},d=["REJECTED"],u=["FULFILLED"],_=["PENDING"];e.exports=i=o,o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){if("function"!=typeof t&&this.state===u||"function"!=typeof e&&this.state===d)return this;var i=new this.constructor(h);this.state!==_?r(i,this.state===u?t:e,this.outcome):this.queue.push(new n(i,t,e));return i},n.prototype.callFulfilled=function(t){p.resolve(this.promise,t)},n.prototype.otherCallFulfilled=function(t){r(this.promise,this.onFulfilled,t)},n.prototype.callRejected=function(t){p.reject(this.promise,t)},n.prototype.otherCallRejected=function(t){r(this.promise,this.onRejected,t)},p.resolve=function(t,e){var i=l(s,e);if("error"===i.status)return p.reject(t,i.value);var o=i.value;if(o)a(t,o);else{t.state=u,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callFulfilled(e)}return t},p.reject=function(t,e){t.state=d,t.outcome=e;for(var i=-1,o=t.queue.length;++i<o;)t.queue[i].callRejected(e);return t},i.resolve=function(t){return t instanceof this?t:p.resolve(new this(h),t)},i.reject=function(t){var e=new this(h);return p.reject(e,t)},i.all=function(t){function e(t,e){i.resolve(t).then(function(t){r[e]=t,++s!==o||n||(n=!0,p.resolve(l,r))},function(t){n||(n=!0,p.reject(l,t))})}var i=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var o=t.length,n=!1;if(!o)return this.resolve([]);for(var r=new Array(o),s=0,a=-1,l=new this(h);++a<o;)e(t[a],a);return l},i.race=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var i,o=t.length,n=!1;if(!o)return this.resolve([]);for(var r=-1,s=new this(h);++r<o;)i=t[r],e.resolve(i).then(function(t){n||(n=!0,p.resolve(s,t))},function(t){n||(n=!0,p.reject(s,t))});return s}},{immediate:2}],2:[function(t,c,e){(function(e){"use strict";function i(){l=!0;for(var t,e,i=h.length;i;){for(e=h,h=[],t=-1;++t<i;)e[t]();i=h.length}l=!1}var o,t=e.MutationObserver||e.WebKitMutationObserver;if(t){var n=0,r=new t(i),s=e.document.createTextNode("");r.observe(s,{characterData:!0}),o=function(){s.data=n=++n%2}}else if(e.setImmediate||void 0===e.MessageChannel)o="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){i(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(i,0)};else{var a=new e.MessageChannel;a.port1.onmessage=i,o=function(){a.port2.postMessage(0)}}var l,h=[];c.exports=function(t){1!==h.push(t)||l||o()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(t,o,e){(function(a){"use strict";var e=t("./jsonp"),i=t("lie");o.exports=function(o,n){if((n=n||{}).jsonp)return e(o,n);var r,s,t=new i(function(t,e){var i;s=e,void 0===a.XMLHttpRequest&&e("XMLHttpRequest is not supported"),(r=new a.XMLHttpRequest).open("GET",o),n.headers&&Object.keys(n.headers).forEach(function(t){r.setRequestHeader(t,n.headers[t])}),r.onreadystatechange=function(){4===r.readyState&&(r.status<400&&n.local||200===r.status?(a.JSON?i=JSON.parse(r.responseText):e(new Error("JSON is not supported")),t(i)):e(r.status?r.statusText:"Attempted cross origin request without CORS enabled"))},r.send()});return t.catch(function(t){return r.abort(),t}),t.abort=s,t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./jsonp":5,lie:1}],4:[function(e,t,i){(function(t){"use strict";var r=t.L||e("leaflet"),s=e("lie"),n=e("./ajax");r.GeoJSON.AJAX=r.GeoJSON.extend({defaultAJAXparams:{dataType:"json",callbackParam:"callback",local:!1,middleware:function(t){return t}},initialize:function(t,e){this.urls=[],t&&("string"==typeof t?this.urls.push(t):"function"==typeof t.pop?this.urls=this.urls.concat(t):(e=t,t=void 0));var i=r.Util.extend({},this.defaultAJAXparams);for(var o in e)this.defaultAJAXparams.hasOwnProperty(o)&&(i[o]=e[o]);this.ajaxParams=i,this._layers={},r.Util.setOptions(this,e),this.on("data:loaded",function(){this.filter&&this.refilter(this.filter)},this);var n=this;0<this.urls.length&&new s(function(t){t()}).then(function(){n.addUrl()})},clearLayers:function(){return this.urls=[],r.GeoJSON.prototype.clearLayers.call(this),this},addUrl:function(t){var i=this;t&&("string"==typeof t?i.urls.push(t):"function"==typeof t.pop&&(i.urls=i.urls.concat(t)));var e=i.urls.length,o=0;i.fire("data:loading"),i.urls.forEach(function(t){"json"===i.ajaxParams.dataType.toLowerCase()?n(t,i.ajaxParams).then(function(t){var e=i.ajaxParams.middleware(t);i.addData(e),i.fire("data:progress",e)},function(t){i.fire("data:progress",{error:t})}):"jsonp"===i.ajaxParams.dataType.toLowerCase()&&r.Util.jsonp(t,i.ajaxParams).then(function(t){var e=i.ajaxParams.middleware(t);i.addData(e),i.fire("data:progress",e)},function(t){i.fire("data:progress",{error:t})})}),i.on("data:progress",function(){++o===e&&i.fire("data:loaded")})},refresh:function(t){t=t||this.urls,this.clearLayers(),this.addUrl(t)},refilter:function(e){"function"!=typeof e?(this.filter=!1,this.eachLayer(function(t){t.setStyle({stroke:!0,clickable:!0})})):(this.filter=e,this.eachLayer(function(t){e(t.feature)?t.setStyle({stroke:!0,clickable:!0}):t.setStyle({stroke:!1,clickable:!1})}))}}),r.Util.Promise=s,r.Util.ajax=n,r.Util.jsonp=e("./jsonp"),r.geoJson.ajax=function(t,e){return new r.GeoJSON.AJAX(t,e)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./ajax":3,"./jsonp":5,leaflet:void 0,lie:1}],5:[function(t,o,e){(function(p){"use strict";var e=p.L||t("leaflet"),i=t("lie");o.exports=function(o,n){n=n||{};var r,s,a,l,h=document.getElementsByTagName("head")[0],c=e.DomUtil.create("script","",h),t=new i(function(e,t){l=t;var i=n.cbParam||"callback";r=n.callbackName?n.callbackName:"_leafletJSONPcallbacks."+(a="_"+(""+Math.random()).slice(2)),c.type="text/javascript",a&&(p._leafletJSONPcallbacks||(p._leafletJSONPcallbacks={length:0}),p._leafletJSONPcallbacks.length++,p._leafletJSONPcallbacks[a]=function(t){h.removeChild(c),delete p._leafletJSONPcallbacks[a],p._leafletJSONPcallbacks.length--,p._leafletJSONPcallbacks.length||delete p._leafletJSONPcallbacks,e(t)}),s=-1===o.indexOf("?")?o+"?"+i+"="+r:o+"&"+i+"="+r,c.src=s}).then(null,function(t){return h.removeChild(c),delete e.Util.ajax.cb[a],t});return t.abort=l,t}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{leaflet:void 0,lie:1}]},{},[4]),function(i){var o={};function n(t){if(o[t])return o[t].exports;var e=o[t]={i:t,l:!1,exports:{}};return i[t].call(e.exports,e,e.exports,n),e.l=!0,e.exports}n.m=i,n.c=o,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=3)}([function(t,e){L.Control.BrowserPrint.Size={A:{Width:840,Height:1188},B:{Width:1e3,Height:1414},C:{Width:916,Height:1296},D:{Width:770,Height:1090},LETTER:{Width:216,Height:279},HALFLETTER:{Width:140,Height:216},LEGAL:{Width:216,Height:356},JUNIORLEGAL:{Width:127,Height:203},TABLOID:{Width:279,Height:432},LEDGER:{Width:432,Height:279}},L.Control.BrowserPrint.Mode=function(t,e,i,o,n){if(!t)throw"Print mode should be specified.";this.Mode=t,this.Title=e||t,this.PageSize=(i||"A4").toUpperCase(),this.PageSeries=-1!=["A","B","C","D"].indexOf(this.PageSize[0])?this.PageSize[0]:"",this.PageSeriesSize=this.PageSize.substring(this.PageSeries.length),this.Action=o||function(t,e){return function(){t["_print"+e.Mode](e)}},this.InvalidateBounds=n},L.Control.BrowserPrint.Mode.Landscape="Landscape",L.Control.BrowserPrint.Mode.Portrait="Portrait",L.Control.BrowserPrint.Mode.Auto="Auto",L.Control.BrowserPrint.Mode.Custom="Custom",L.Control.BrowserPrint.Mode.prototype.getPageMargin=function(){var t=this.getPaperSize();return Math.floor((t.Width+t.Height)/40)+"mm"},L.Control.BrowserPrint.Mode.prototype.getPaperSize=function(){if(this.PageSeries){var t=L.Control.BrowserPrint.Size[this.PageSeries],e=t.Width,i=t.Height,o=!1;return this.PageSeriesSize&&(this.PageSeriesSize=+this.PageSeriesSize,(o=this.PageSeriesSize%2==1)?(e/=this.PageSeriesSize-1||1,i/=this.PageSeriesSize+1):(e/=this.PageSeriesSize,i/=this.PageSeriesSize)),{Width:o?i:e,Height:o?e:i}}var n=L.Control.BrowserPrint.Size[this.PageSeriesSize];return{Width:n.Width,Height:n.Height}},L.Control.BrowserPrint.Mode.prototype.getSize=function(){function t(t){return i?t-2*i:t}var e=this.getPaperSize(),i=parseInt(this.getPageMargin());return e.Width=Math.floor(t(e.Width))+"mm",e.Height=Math.floor(t(e.Height))+"mm",e},L.control.browserPrint.mode=function(t,e,i,o,n){return new L.Control.BrowserPrint.Mode(t,e,i,o,n)},L.control.browserPrint.mode.portrait=function(t,e,i){return L.control.browserPrint.mode(L.Control.BrowserPrint.Mode.Portrait,t,e,i,!1)},L.control.browserPrint.mode.landscape=function(t,e,i){return L.control.browserPrint.mode(L.Control.BrowserPrint.Mode.Landscape,t,e,i,!1)},L.control.browserPrint.mode.auto=function(t,e,i){return L.control.browserPrint.mode(L.Control.BrowserPrint.Mode.Auto,t,e,i,!0)},L.control.browserPrint.mode.custom=function(t,e,i){return L.control.browserPrint.mode(L.Control.BrowserPrint.Mode.Custom,t,e,i,!0)}},function(t,e){L.Control.BrowserPrint.Utils={_ignoreArray:[],_cloneFactoryArray:[],_cloneRendererArray:[],_knownRenderers:{},cloneOptions:function(t){var e={};for(var i in t){var o=t[i];o&&o.clone?e[i]=o.clone():o&&o.onAdd?e[i]=this.cloneLayer(o):e[i]=o}return e},cloneBasicOptionsWithoutLayers:function(t){var e={},i=Object.getOwnPropertyNames(t);if(i.length){for(var o=0;o<i.length;o++){var n=i[o];n&&"layers"!=n&&(e[n]=t[n])}return this.cloneOptions(e)}return e},cloneInnerLayers:function(t){var i=this,o=[];return t.eachLayer(function(t){var e=i.cloneLayer(t);e&&o.push(e)}),o},initialize:function(){this._knownRenderers={},this.registerRenderer(L.SVG,"L.SVG"),this.registerRenderer(L.Canvas,"L.Canvas"),this.registerLayer(L.TileLayer.WMS,"L.TileLayer.WMS",function(t,e){return L.tileLayer.wms(t._url,e.cloneOptions(t.options))}),this.registerLayer(L.TileLayer,"L.TileLayer",function(t,e){return L.tileLayer(t._url,e.cloneOptions(t.options))}),this.registerLayer(L.GridLayer,"L.GridLayer",function(t,e){return L.gridLayer(e.cloneOptions(t.options))}),this.registerLayer(L.ImageOverlay,"L.ImageOverlay",function(t,e){return L.imageOverlay(t._url,t._bounds,e.cloneOptions(t.options))}),this.registerLayer(L.Marker,"L.Marker",function(t,e){return L.marker(t.getLatLng(),e.cloneOptions(t.options))}),this.registerLayer(L.Popup,"L.Popup",function(t,e){return L.popup(e.cloneOptions(t.options)).setLatLng(t.getLatLng()).setContent(t.getContent())}),this.registerLayer(L.Circle,"L.Circle",function(t,e){return L.circle(t.getLatLng(),t.getRadius(),e.cloneOptions(t.options))}),this.registerLayer(L.CircleMarker,"L.CircleMarker",function(t,e){return L.circleMarker(t.getLatLng(),e.cloneOptions(t.options))}),this.registerLayer(L.Rectangle,"L.Rectangle",function(t,e){return L.rectangle(t.getBounds(),e.cloneOptions(t.options))}),this.registerLayer(L.Polygon,"L.Polygon",function(t,e){return L.polygon(t.getLatLngs(),e.cloneOptions(t.options))}),this.registerLayer(L.MultiPolyline,"L.MultiPolyline",function(t,e){return L.polyline(t.getLatLngs(),e.cloneOptions(t.options))}),this.registerLayer(L.MultiPolygon,"L.MultiPolygon",function(t,e){return L.multiPolygon(t.getLatLngs(),e.cloneOptions(t.options))}),this.registerLayer(L.Polyline,"L.Polyline",function(t,e){return L.polyline(t.getLatLngs(),e.cloneOptions(t.options))}),this.registerLayer(L.GeoJSON,"L.GeoJSON",function(t,e){return L.geoJson(t.toGeoJSON(),e.cloneOptions(t.options))}),this.registerIgnoreLayer(L.FeatureGroup,"L.FeatureGroup"),this.registerIgnoreLayer(L.LayerGroup,"L.LayerGroup"),this.registerLayer(L.Tooltip,"L.Tooltip",function(){return null})},_register:function(t,e,i,o){e&&!t.filter(function(t){return t.identifier===i}).length&&t.push({type:e,identifier:i,builder:o||function(t){return new e(t.options)}})},registerLayer:function(t,e,i){this._register(this._cloneFactoryArray,t,e,i)},registerRenderer:function(t,e,i){this._register(this._cloneRendererArray,t,e,i)},registerIgnoreLayer:function(t,e){this._register(this._ignoreArray,t,e)},cloneLayer:function(t){return t?this.__getRenderer(t)||((e=t._group?this.__getFactoryObject(t._group,!0):this.__getFactoryObject(t))&&(e=e.builder(t,this)),e):null;var e},getType:function(t){if(!t)return null;var e=this.__getFactoryObject(t);return e=e&&e.identifier},__getRenderer:function(t){var e=this._knownRenderers[t._leaflet_id];if(!e){for(var i=0;i<this._cloneRendererArray.length;i++){var o=this._cloneRendererArray[i];if(t instanceof o.type){this._knownRenderers[t._leaflet_id]=o.builder(t.options);break}}e=this._knownRenderers[t._leaflet_id]}return e},__getFactoryObject:function(t,e){if(!e)for(var i=0;i<this._ignoreArray.length;i++){var o=this._ignoreArray[i];if(o.type&&t instanceof o.type)return null}for(i=0;i<this._cloneFactoryArray.length;i++)if((n=this._cloneFactoryArray[i]).type&&t instanceof n.type)return n;for(i=0;i<this._cloneRendererArray.length;i++){var n;if((n=this._cloneRendererArray[i]).type&&t instanceof n.type)return null}return this.__unknownLayer__(),null},__unknownLayer__:function(){console.warn("Unknown layer, cannot clone this layer. Leaflet version: "+L.version),console.info("For additional information please refer to documentation on: https://github.com/Igor-Vladyka/leaflet.browser.print."),console.info("-------------------------------------------------------------------------------------------------------------------")}}},function(t,e){L.Control.BrowserPrint=L.Control.extend({options:{title:"Print map",documentTitle:"",position:"topleft",printLayer:null,printModes:["Portrait","Landscape","Auto","Custom"],closePopupsOnPrint:!0,contentSelector:"[leaflet-browser-print-content]",pagesSelector:"[leaflet-browser-print-pages]",manualMode:!1,customPrintStyle:{color:"gray",dashArray:"5, 10",pane:"customPrintPane"}},onAdd:function(t){this.options.customPrintStyle.pane&&!t.getPane(this.options.customPrintStyle.pane)&&(t.createPane(this.options.customPrintStyle.pane).style.zIndex=9999);var e=L.DomUtil.create("div","leaflet-control-browser-print leaflet-bar leaflet-control");return L.DomEvent.disableClickPropagation(e),this._appendControlStyles(e),1<this.options.printModes.length?(L.DomEvent.addListener(e,"mouseover",this._displayPageSizeButtons,this),L.DomEvent.addListener(e,"mouseout",this._hidePageSizeButtons,this)):e.style.cursor="pointer",0<this.options.position.indexOf("left")?(this._createIcon(e),this._createMenu(e)):(this._createMenu(e),this._createIcon(e)),t.printControl=this,e},_createIcon:function(t){return this.__link__=L.DomUtil.create("a","",t),this.__link__.className="leaflet-browser-print",this.options.title&&(this.__link__.title=this.options.title),this.__link__},_createMenu:function(t){for(var e=[],i=0;i<this.options.printModes.length;i++){var o=this.options.printModes[i];if(o.length){var n=o[0].toUpperCase()+o.substring(1).toLowerCase();o=L.control.browserPrint.mode[o.toLowerCase()](this._getDefaultTitle(n))}else if(!(o instanceof L.Control.BrowserPrint.Mode))throw"Invalid Print Mode. Can't construct logic to print current map.";1==this.options.printModes.length?o.Element=t:(o.Element=L.DomUtil.create("li","browser-print-mode",L.DomUtil.create("ul","browser-print-holder",t)),o.Element.innerHTML=o.Title),L.DomEvent.addListener(o.Element,"click",o.Action(this,o),this),e.push(o)}this.options.printModes=e},_getDefaultTitle:function(t){return this.options.printModesNames&&this.options.printModesNames[t]||t},_displayPageSizeButtons:function(){0<this.options.position.indexOf("left")?(this.__link__.style.borderTopRightRadius="0px",this.__link__.style.borderBottomRightRadius="0px"):(this.__link__.style.borderTopLeftRadius="0px",this.__link__.style.borderBottomLeftRadius="0px"),this.options.printModes.forEach(function(t){t.Element.style.display="inline-block"})},_hidePageSizeButtons:function(){0<this.options.position.indexOf("left")?(this.__link__.style.borderTopRightRadius="",this.__link__.style.borderBottomRightRadius=""):(this.__link__.style.borderTopLeftRadius="",this.__link__.style.borderBottomLeftRadius=""),this.options.printModes.forEach(function(t){t.Element.style.display=""})},_getMode:function(t,e){return new L.control.browserPrint.mode(t,e.Title,e.PageSize,e.Action,e.InvalidateBounds)},_printLandscape:function(t){this._addPrintClassToContainer(this._map,"leaflet-browser-print--landscape"),this._print(t)},_printPortrait:function(t){this._addPrintClassToContainer(this._map,"leaflet-browser-print--portrait"),this._print(t)},_printAuto:function(t){this._addPrintClassToContainer(this._map,"leaflet-browser-print--auto");var e=this._getBoundsForAllVisualLayers(),i=this._getPageSizeFromBounds(e);this._print(this._getMode(i,t),e)},_printCustom:function(t){this._addPrintClassToContainer(this._map,"leaflet-browser-print--custom"),this.options.custom={mode:t},this._map.on("mousedown",this._startAutoPoligon,this)},_addPrintClassToContainer:function(t,e){var i=t.getContainer();-1===i.className.indexOf(e)&&(i.className+=" "+e)},_removePrintClassFromContainer:function(t,e){var i=t.getContainer();i.className&&-1<i.className.indexOf(e)&&(i.className=i.className.replace(" "+e,""))},_startAutoPoligon:function(t){t.originalEvent.preventDefault(),t.originalEvent.stopPropagation(),this._map.dragging.disable(),this.options.custom.start=t.latlng,this._map.off("mousedown",this._startAutoPoligon,this),this._map.on("mousemove",this._moveAutoPoligon,this),this._map.on("mouseup",this._endAutoPoligon,this)},_moveAutoPoligon:function(t){this.options.custom&&(t.originalEvent.preventDefault(),t.originalEvent.stopPropagation(),this.options.custom.rectangle?this.options.custom.rectangle.setBounds(L.latLngBounds(this.options.custom.start,t.latlng)):(this.options.custom.rectangle=L.rectangle([this.options.custom.start,t.latlng],this.options.customPrintStyle),this.options.custom.rectangle.addTo(this._map)))},_endAutoPoligon:function(t){if(t.originalEvent.preventDefault(),t.originalEvent.stopPropagation(),this._map.off("mousemove",this._moveAutoPoligon,this),this._map.off("mouseup",this._endAutoPoligon,this),this._map.dragging.enable(),this.options.custom&&this.options.custom.rectangle){var e=this.options.custom.rectangle.getBounds();this._map.removeLayer(this.options.custom.rectangle);var i=this._getPageSizeFromBounds(e);this._print(this._getMode(i,this.options.custom.mode),e),delete this.options.custom}else this._clearPrint()},_getPageSizeFromBounds:function(t){return Math.abs(t.getNorth()-t.getSouth())>Math.abs(t.getEast()-t.getWest())?"Portrait":"Landscape"},_setupPrintPagesWidth:function(t,e,i){t.style.width="Landscape"===i?e.Height:e.Width},_setupPrintMapHeight:function(t,e,i){t.style.height="Landscape"===i?e.Width:e.Height},cancel:function(t){this.cancelNextPrinting=t},print:function(t,e){this._print(this._getMode(t.Mode,t),e)},_print:function(t,e){this._map.fire(L.Control.BrowserPrint.Event.PrintInit,{mode:t}),L.Control.BrowserPrint.Utils.initialize();var i=this,o=this._map.getContainer(),n=t.Mode,r={bounds:e||this._map.getBounds(),width:o.style.width,height:o.style.height,documentTitle:document.title,printLayer:L.Control.BrowserPrint.Utils.cloneLayer(this.options.printLayer),panes:[]},s=this._map.getPanes();for(var a in s)r.panes.push({name:a,container:void 0});if(r.printObjects=this._getPrintObjects(r.printLayer),this._map.fire(L.Control.BrowserPrint.Event.PrePrint,{printLayer:r.printLayer,printObjects:r.printObjects,pageOrientation:n,printMode:t.Mode,pageBounds:r.bounds}),this.cancelNextPrinting)delete this.cancelNextPrinting;else{var l=this._addPrintMapOverlay(t.PageSize,t.getPageMargin(),t.getSize(),n,r);this.options.documentTitle&&(document.title=this.options.documentTitle),this._map.fire(L.Control.BrowserPrint.Event.PrintStart,{printLayer:r.printLayer,printMap:l.map,printObjects:l.objects}),t.InvalidateBounds?(l.map.fitBounds(r.bounds),l.map.invalidateSize({reset:!0,animate:!1,pan:!1})):l.map.setView(this._map.getCenter(),this._map.getZoom());var h=setInterval(function(){i._isTilesLoading(l.map)||(clearInterval(h),i.options.manualMode?i._setupManualPrintButton(l.map,r,l.objects):i._completePrinting(l.map,r,l.objects))},50)}},_completePrinting:function(e,i,o){var n=this;setTimeout(function(){n._map.fire(L.Control.BrowserPrint.Event.Print,{printLayer:i.printLayer,printMap:e,printObjects:o});var t=window.print();t?Promise.all([t]).then(function(){n._printEnd(i),n._map.fire(L.Control.BrowserPrint.Event.PrintEnd,{printLayer:i.printLayer,printMap:e,printObjects:o})}):(n._printEnd(i),n._map.fire(L.Control.BrowserPrint.Event.PrintEnd,{printLayer:i.printLayer,printMap:e,printObjects:o}))},1e3)},_getBoundsForAllVisualLayers:function(){var t=null;for(var e in this._map._layers){var i=this._map._layers[e];i._url||i._mutant||(t?i.getBounds?t.extend(i.getBounds()):i.getLatLng&&t.extend(i.getLatLng()):i.getBounds?t=i.getBounds():i.getLatLng&&(t=L.latLngBounds(i.getLatLng(),i.getLatLng())))}return t=t||this._map.getBounds()},_clearPrint:function(){this._removePrintClassFromContainer(this._map,"leaflet-browser-print--landscape"),this._removePrintClassFromContainer(this._map,"leaflet-browser-print--portrait"),this._removePrintClassFromContainer(this._map,"leaflet-browser-print--auto"),this._removePrintClassFromContainer(this._map,"leaflet-browser-print--custom")},_printEnd:function(t){this._clearPrint(),document.body.removeChild(this.__overlay__),this.__overlay__=null,document.body.className=document.body.className.replace(" leaflet--printing",""),this.options.documentTitle&&(document.title=t.documentTitle),this._map.invalidateSize({reset:!0,animate:!1,pan:!1})},_getPrintObjects:function(t){var e={};for(var i in this._map._layers){var o=this._map._layers[i];if(!t||!o._url||o instanceof L.TileLayer.WMS){var n=L.Control.BrowserPrint.Utils.getType(o);n&&(e[n]||(e[n]=[]),e[n].push(o))}}return e},_addPrintCss:function(t,e,i){var o=document.createElement("style");switch(o.className="leaflet-browser-print-css",o.setAttribute("type","text/css"),o.innerHTML=" @media print { .leaflet-popup-content-wrapper, .leaflet-popup-tip { box-shadow: none; }",o.innerHTML+=" .leaflet-browser-print--manualMode-button { display: none; }",o.innerHTML+=" * { -webkit-print-color-adjust: exact!important; printer-colors: exact!important; color-adjust: exact!important; }",e&&(o.innerHTML+=" @page { margin: "+e+"; }"),o.innerHTML+=" @page :first { page-break-after: always; }",i){case"Landscape":o.innerText+=" @page { size : "+t+" landscape; }";break;default:o.innerText+=" @page { size : "+t+" portrait; }"}return o},_appendControlStyles:function(t){var e=document.createElement("style");e.setAttribute("type","text/css"),e.innerHTML+=" .leaflet-control-browser-print { display: flex; } .leaflet-control-browser-print a { background: #fff url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH3gcCCi8Vjp+aNAAAAGhJREFUOMvFksENgDAMA68RC7BBN+Cf/ZU33QAmYAT6BolAGxB+RrrIsg1BpfNBVXcPMLMDI/ytpKozMHWwK7BJJ7yYWQbGdBea9wTIkRDzKy0MT7r2NiJACRgotCzxykFI34QY2Ea7KmtxGJ+uX4wfAAAAAElFTkSuQmCC') no-repeat 5px; background-size: 16px 16px; display: block; border-radius: 2px; }",e.innerHTML+=" .leaflet-control-browser-print a.leaflet-browser-print { background-position-x: 7px; }",e.innerHTML+=" .browser-print-holder { margin: 0px; padding: 0px; list-style: none; white-space: nowrap; } .browser-print-holder-left li:last-child { border-top-right-radius: 2px; border-bottom-right-radius: 2px; } .browser-print-holder-right li:first-child { border-top-left-radius: 2px; border-bottom-left-radius: 2px; }",e.innerHTML+=" .browser-print-mode { display: none; background-color: #919187; color: #FFF; font: 11px/19px 'Helvetica Neue', Arial, Helvetica, sans-serif; text-decoration: none; padding: 4px 10px; text-align: center; } .browser-print-mode { padding: 6px 10px; } .browser-print-mode:hover { background-color: #757570; cursor: pointer; }",e.innerHTML+=" .leaflet-browser-print--custom, .leaflet-browser-print--custom path { cursor: crosshair!important; }",e.innerHTML+=" .leaflet-print-overlay { width: 100%; height:auto; min-height: 100%; position: absolute; top: 0; background-color: white!important; left: 0; z-index: 1001; display: block!important; } ",e.innerHTML+=" .leaflet--printing { height:auto; min-height: 100%; margin: 0px!important; padding: 0px!important; } body.leaflet--printing > * { display: none; box-sizing: border-box; }",e.innerHTML+=" .grid-print-container { grid-template: 1fr / 1fr; box-sizing: border-box; } .grid-map-print { grid-row: 1; grid-column: 1; } body.leaflet--printing .grid-print-container [leaflet-browser-print-content]:not(style) { display: unset!important; }",e.innerHTML+=" .pages-print-container { box-sizing: border-box; }",t.appendChild(e)},_setupManualPrintButton:function(t,e,i){var o=document.createElement("button");o.className="leaflet-browser-print--manualMode-button",o.innerHTML="Print",o.style.position="absolute",o.style.top="20px",o.style.right="20px",this.__overlay__.appendChild(o);var n=this;L.DomEvent.addListener(o,"click",function(){n._completePrinting(t,e,i)})},_addPrintMapOverlay:function(t,e,i,o,n){this.__overlay__=document.createElement("div"),this.__overlay__.className=this._map.getContainer().className+" leaflet-print-overlay",document.body.appendChild(this.__overlay__),this.__overlay__.appendChild(this._addPrintCss(t,e,o));var r=document.createElement("div");if(r.className="grid-print-container",r.style.width="100%",r.style.display="grid",this._setupPrintMapHeight(r,i,o),this.options.contentSelector){var s=document.querySelectorAll(this.options.contentSelector);if(s&&s.length)for(var a=0;a<s.length;a++){var l=s[a].cloneNode(!0);r.appendChild(l)}}if(this.options.pagesSelector&&document.querySelectorAll(this.options.pagesSelector).length){var h=document.createElement("div");h.className="pages-print-container",h.style.margin="0!important",this._setupPrintPagesWidth(h,i,o),this.__overlay__.appendChild(h),h.appendChild(r);var c=document.querySelectorAll(this.options.pagesSelector);if(c&&c.length)for(a=0;a<c.length;a++){var p=c[a].cloneNode(!0);h.appendChild(p)}}else this._setupPrintPagesWidth(r,i,o),this.__overlay__.appendChild(r);var d=document.createElement("div");d.id=this._map.getContainer().id+"-print",d.className="grid-map-print",d.style.width="100%",d.style.height="100%",r.appendChild(d),document.body.className+=" leaflet--printing";var u=L.Control.BrowserPrint.Utils.cloneBasicOptionsWithoutLayers(this._map.options);return u.maxZoom=this._map.getMaxZoom(),this._setupPrintMap(d.id,u,n.printLayer,n.printObjects,n.panes)},_setupPrintMap:function(t,e,i,o,n){e.zoomControl=!1,e.dragging=!1,e.zoomAnimation=!1,e.fadeAnimation=!1,e.markerZoomAnimation=!1,e.keyboard=!1,e.scrollWheelZoom=!1,e.tap=!1,e.touchZoom=!1;var r=L.map(t,e);for(var s in i&&i.addTo(r),n.forEach(function(t){r.createPane(t.name,t.container)}),o){var a=this.options.closePopupsOnPrint;o[s]=o[s].map(function(t){var e=L.Control.BrowserPrint.Utils.cloneLayer(t);if(e){if(t instanceof L.Popup?(t.isOpen||(t.isOpen=function(){return this._isOpen}),t.isOpen()&&!a&&e.openOn(r)):e.addTo(r),t instanceof L.Layer){var i=t.getTooltip();i&&(e.bindTooltip(i.getContent(),i.options),t.isTooltipOpen()&&e.openTooltip(i.getLatLng()))}return e}})}return{map:r,objects:o}},_isTilesLoading:function(t){return 1<parseFloat(L.version)?this._getLoadingLayers(t):t._tilesToLoad||t._tileLayersToLoad},_getLoadingLayers:function(t){for(var e in t._layers){var i=t._layers[e];if((i._url||i._mutant)&&i._loading)return!0}return!1}}),L.Control.BrowserPrint.Event={PrintInit:"browser-print-init",PrePrint:"browser-pre-print",PrintStart:"browser-print-start",Print:"browser-print",PrintEnd:"browser-print-end"},L.control.browserPrint=function(t){if(t&&t.printModes||((t=t||{}).printModes=[L.control.browserPrint.mode.portrait(),L.control.browserPrint.mode.landscape(),L.control.browserPrint.mode.auto(),L.control.browserPrint.mode.custom()]),t&&t.printModes&&(!t.printModes.filter||!t.printModes.length))throw"Please specify valid print modes for Print action. Example: printModes: [L.control.browserPrint.mode.portrait(), L.control.browserPrint.mode.auto('Automatico'), 'Custom']";return t.printModesNames&&console.warn("'printModesNames' option is obsolete. Please use 'L.control.browserPrint.mode.*(/*Title*/)' shortcut instead. Please check latest release and documentation."),new L.Control.BrowserPrint(t)}},function(t,e,i){i(2),i(1),t.exports=i(0)}]),function(t,e){"function"==typeof define&&define.amd?define(["leaflet"],e):"object"==typeof exports?module.exports=e(require("leaflet")):t.L.Control.DefaultExtent=e(t.L)}(this,function(e){return function(){"use strict";return e.Control.DefaultExtent=e.Control.extend({options:{position:"topleft",text:"Default Extent",title:"Zoom to default extent",className:"leaflet-control-defaultextent"},onAdd:function(t){return this._map=t,this._initLayout()},setCenter:function(t){return this._center=t,this},setZoom:function(t){return this._zoom=t,this},_initLayout:function(){var t=e.DomUtil.create("div","leaflet-bar "+this.options.className);return this._container=t,this._fullExtentButton=this._createExtentButton(t),e.DomEvent.disableClickPropagation(t),this._map.whenReady(this._whenReady,this),this._container},_createExtentButton:function(){var t=e.DomUtil.create("a",this.options.className+"-toggle",this._container);return t.href="#",t.innerHTML=this.options.text,t.title=this.options.title,e.DomEvent.on(t,"mousedown dblclick",e.DomEvent.stopPropagation).on(t,"click",e.DomEvent.stop).on(t,"click",this._zoomToDefault,this),t},_whenReady:function(){return this._center||(this._center=this._map.getCenter()),this._zoom||(this._zoom=this._map.getZoom()),this},_zoomToDefault:function(){this._map.setView(this._center,this._zoom)}}),e.Map.addInitHook(function(){this.options.defaultExtentControl&&this.addControl(new e.Control.DefaultExtent)}),e.control.defaultExtent=function(t){return new e.Control.DefaultExtent(t)},e.Control.DefaultExtent}()}),function(e){L.drawVersion="0.2.3-dev",L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes.",text:"Save"},cancel:{title:"Cancel editing, discards all changes.",text:"Cancel"}},buttons:{edit:"Edit layers.",editDisabled:"No layers to edit.",remove:"Delete layers.",removeDisabled:"No layers to delete."}},handlers:{edit:{tooltip:{text:"Drag handles, or marker to edit feature.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove"}}}}},L.Draw={},L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.Util.extend(this.options,e)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire("draw:drawstart",{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this.fire("disabled",{handler:this.type}),this._map.fire("draw:drawstop",{layerType:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Tooltip(this._map),L.DomEvent.addListener(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.removeListener(this._container,"keyup",this._cancelDrawing))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire("draw:created",{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&&this.disable()}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),guidelineDistance:20,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,showLength:!0,zIndexOffset:2e3},initialize:function(t,e){this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mousemove",this._onMouseMove,this).off("zoomend",this._onZoomEnd,this)},_finishShape:function(){var t=this._poly.newLatLngIntersects(this._poly.getLatLngs()[0],!0);return!this.options.allowIntersection&&t||!this._shapeIsValid()?void this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),void(this.options.repeatMode&&this.enable()))},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._updateGuide()},_onMouseMove:function(t){var e=t.layerPoint,i=t.latlng;this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_onClick:function(t){var e=t.target.getLatLng();return 0<this._markers.length&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(e)?void this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(e)),this._poly.addLatLng(e),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),this._updateFinishHandler(),this._vertexAdded(e),this._clearGuides(),void this._updateTooltip())},_updateFinishHandler:function(){var t=this._markers.length;1<t&&this._markers[t-1].on("click",this._finishShape,this),2<t&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers.length;0<e&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,o,n,r,s=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)));for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane)),i=this.options.guidelineDistance;i<s;i+=this.options.guidelineDistance)o=i/s,n={x:Math.floor(t.x*(1-o)+o*e.x),y:Math.floor(t.y*(1-o)+o*e.y)},(r=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer)).style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(r,n)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;e<i;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e=this.options.showLength;return 0===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(t=e?this._getMeasurementString():"",1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:t}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:t})},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=this._measurementRunningTotal+e.distanceTo(i),L.GeometryUtil.readableDistance(t,this.options.metric)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_vertexAdded:function(t){1===this._markers.length?this._measurementRunningTotal=0:this._measurementRunningTotal+=t.distanceTo(this._markers[this._markers.length-2].getLatLng())},_cleanUpShape:function(){1<this._markers.length&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),2<t&&(this._markers[t-1].on("dblclick",this._finishShape,this),3<t&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?t=L.drawLocal.draw.handlers.polygon.tooltip.cont:(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area;return t?L.GeometryUtil.readableArea(t,this.options.metric):null},_shapeIsValid:function(){return 3<=this._markers.length},_vertexAdded:function(){if(!this.options.allowIntersection&&this.options.showArea){var t=this._poly.getLatLngs();this._area=L.GeometryUtil.geodesicArea(t)}},_cleanUpShape:function(){var t=this._markers.length;0<t&&(this._markers[0].off("click",this._finishShape,this),2<t&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent({text:this._endLabelText}),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(t)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,o=(this.options.metric,this.options.showRadius),n=this.options.metric;this._tooltip.updatePosition(i),this._isDrawing&&(this._drawShape(i),e=this._shape.getRadius().toFixed(1),this._tooltip.updateContent({text:this._endLabelText,subtext:o?"Radius: "+L.GeometryUtil.readableDistance(e,n):""}))}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?this._marker.setLatLng(e):(this._marker=new L.Marker(e,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_fireCreatedEvent:function(){var t=new L.Marker(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(t,e){this._poly=t,L.setOptions(this,e)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,o,n,r,s=this._poly._latlngs;for(t=0,i=s.length;t<i;t++)(o=this._createMarker(s[t],t)).on("click",this._onMarkerClick,this),this._markers.push(o);for(t=0,e=i-1;t<i;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(n=this._markers[e],r=this._markers[t],this._createMiddleMarker(n,r),this._updatePrevNext(n,r))},_createMarker:function(t,e){var i=new L.Marker(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on("drag",this._onMarkerDrag,this),i.on("dragend",this._fireEdit,this),this._markerGroup.addLayer(i),i},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._poly.spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("click",this._onMarkerClick,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit")},_onMarkerDrag:function(t){var e=t.target;L.extend(e._origLatLng,e._latlng),e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly.redraw()},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;e>this._poly._latlngs.length||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_updateIndexes:function(e,i){this._markerGroup.eachLayer(function(t){t._index>e&&(t._index+=i)})},_createMiddleMarker:function(e,i){var o,t,n,r=this._getMiddleLatLng(e,i),s=this._createMarker(r);s.setOpacity(.6),e._middleRight=i._middleLeft=s,t=function(){var t=i._index;s._index=t,s.off("click",o,this).on("click",this._onMarkerClick,this),r.lat=s.getLatLng().lat,r.lng=s.getLatLng().lng,this._poly.spliceLatLngs(t,0,r),this._markers.splice(t,0,s),s.setOpacity(1),this._updateIndexes(t,1),i._index++,this._updatePrevNext(e,s),this._updatePrevNext(s,i)},n=function(){s.off("dragstart",t,this),s.off("dragend",n,this),this._createMiddleMarker(e,s),this._createMiddleMarker(s,i)},o=function(){t.call(this),n.call(this),this._fireEdit()},s.on("click",o,this).on("dragstart",t,this).on("dragend",n,this),this._markerGroup.addLayer(s)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,o=i.project(t.getLatLng()),n=i.project(e.getLatLng());return i.unproject(o._add(n)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"})},initialize:function(t,e){this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){this._shape._map&&(this._map=this._shape._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup))},removeHooks:function(){if(this._shape._map){this._unbindMarker(this._moveMarker);for(var t=0,e=this._resizeMarkers.length;t<e;t++)this._unbindMarker(this._resizeMarkers[t]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this)},_onMarkerDragStart:function(t){t.target.setOpacity(0)},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw()},_onMarkerDragEnd:function(t){t.target.setOpacity(1),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds().getCenter();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;e<i;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),i=t.target._cornerIndex;this._oppositeCorner=e[(i+2)%4],this._toggleCornerMarkers(0,i)},_onMarkerDragEnd:function(t){var e,i=t.target;i===this._moveMarker&&(e=this._shape.getBounds().getCenter(),i.setLatLng(e)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape.getLatLngs(),o=this._shape.getBounds().getCenter(),n=[],r=0,s=i.length;r<s;r++)e=[i[r].lat-o.lat,i[r].lng-o.lng],n.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(n),this._repositionCornerMarkers()},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter())},_getCorners:function(){var t=this._shape.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;e<i;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_move:function(t){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e),this._shape.setLatLng(t)},_resize:function(t){var e=this._moveMarker.getLatLng().distanceTo(t);this._shape.setRadius(e)}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,o=t.length;i<o;i++)e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},L.GeometryUtil={geodesicArea:function(t){var e,i,o=t.length,n=0,r=L.LatLng.DEG_TO_RAD;if(2<o){for(var s=0;s<o;s++)e=t[s],n+=((i=t[(s+1)%o]).lng-e.lng)*r*(2+Math.sin(e.lat*r)+Math.sin(i.lat*r));n=40680631590769*n/2}return Math.abs(n)},readableArea:function(t,e){return e?1e4<=t?(1e-4*t).toFixed(2)+" ha":t.toFixed(2)+" m&sup2;":3097600<=(t*=.836127)?(t/3097600).toFixed(2)+" mi&sup2;":4840<=t?(t/4840).toFixed(2)+" acres":Math.ceil(t)+" yd&sup2;"},readableDistance:function(t,e){return e?1e3<t?(t/1e3).toFixed(2)+" km":Math.ceil(t)+" m":1760<(t*=1.09361)?(t/1760).toFixed(2)+" miles":Math.ceil(t)+" yd"}},L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,o){return this._checkCounterclockwise(t,i,o)!==this._checkCounterclockwise(e,i,o)&&this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,o)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,i,o=this._originalPoints,n=o?o.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=n-1;3<=t;t--)if(e=o[t-1],i=o[t],this._lineSegmentsIntersectsRange(e,i,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(t),e)},newPointIntersects:function(t,e){var i=this._originalPoints,o=i?i.length:0,n=i?i[o-1]:null,r=o-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(n,t,r,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._originalPoints,i=e?e.length:0;return i+=t||0,!this._originalPoints||i<=3},_lineSegmentsIntersectsRange:function(t,e,i,o){var n,r,s=this._originalPoints;o=o||0;for(var a=i;o<a;a--)if(n=s[a-1],r=s[a],L.LineUtil.segmentsIntersect(t,e,n,r))return!0;return!1}}),L.Polygon.include({intersects:function(){var t,e,i,o,n=this._originalPoints;return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(t=n.length,e=n[0],i=n[t-1],o=t-2,this._lineSegmentsIntersectsRange(i,e,o,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<="0.5.1")throw Error("Leaflet.draw 0.2.0+ requires Leaflet 0.6.0+. Download latest from https://github.com/Leaflet/Leaflet/");var e,i;L.Control.prototype.initialize.call(this,t),this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),e=L.stamp(i),this._toolbars[e]=i,this._toolbars[e].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),e=L.stamp(i),this._toolbars[e]=i,this._toolbars[e].on("enable",this._toolbarEnabled,this))},onAdd:function(t){var e,i=L.DomUtil.create("div","leaflet-draw"),o=!1,n="leaflet-draw-toolbar-top";for(var r in this._toolbars)this._toolbars.hasOwnProperty(r)&&(e=this._toolbars[r].addToolbar(t),o||(L.DomUtil.hasClass(e,n)||L.DomUtil.addClass(e.childNodes[0],n),o=!0),i.appendChild(e));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=""+L.stamp(t.target);for(var i in this._toolbars)this._toolbars.hasOwnProperty(i)&&i!==e&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;e<i;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,o,n){var r=t.type;this._modes[r]={},this._modes[r].handler=t,this._modes[r].button=this._createButton({title:n,className:o+"-"+r,container:e,callback:this._modes[r].handler.enable,context:this._modes[r].handler}),this._modes[r].buttonIndex=i,this._modes[r].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container);return e.href="#",t.text&&(e.innerHTML=t.text),t.title&&(e.title=t.title),L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,"click",t.callback,t.context),e},_disposeButton:function(t,e){L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,"click",e)},_handlerActivated:function(t){this._activeMode&&this._activeMode.handler.enabled()&&this._activeMode.handler.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){for(var e,i,o=L.DomUtil.create("ul","leaflet-draw-actions"),n=t.length,r=0;r<n;r++)e=L.DomUtil.create("li","",o),i=this._createButton({title:t[r].title,text:t[r].text,container:e,callback:t[r].callback,context:t[r].context}),this._actionButtons.push({button:i,callback:t[r].callback});return o},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=26*t+ +t-1;this._actionsContainer.style.top=i+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}}),L.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1},dispose:function(){this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container&&(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?0<t.subtext.length&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(0<t.subtext.length?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>"),this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&&(i.style.visibility="inherit",L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this}}),L.DrawToolbar=L.Toolbar.extend({options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));L.Toolbar.prototype.initialize.call(this,t)},addToolbar:function(t){var e=L.DomUtil.create("div","leaflet-draw-section"),i=0,o="leaflet-draw-draw";return this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this.options.polyline&&this._initModeHandler(new L.Draw.Polyline(t,this.options.polyline),this._toolbarContainer,i++,o,L.drawLocal.draw.toolbar.buttons.polyline),this.options.polygon&&this._initModeHandler(new L.Draw.Polygon(t,this.options.polygon),this._toolbarContainer,i++,o,L.drawLocal.draw.toolbar.buttons.polygon),this.options.rectangle&&this._initModeHandler(new L.Draw.Rectangle(t,this.options.rectangle),this._toolbarContainer,i++,o,L.drawLocal.draw.toolbar.buttons.rectangle),this.options.circle&&this._initModeHandler(new L.Draw.Circle(t,this.options.circle),this._toolbarContainer,i++,o,L.drawLocal.draw.toolbar.buttons.circle),this.options.marker&&this._initModeHandler(new L.Draw.Marker(t,this.options.marker),this._toolbarContainer,i++,o,L.drawLocal.draw.toolbar.buttons.marker),this._lastButtonIndex=--i,this._actionsContainer=this._createActions([{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]),e.appendChild(this._toolbarContainer),e.appendChild(this._actionsContainer),e},setOptions:function(t){for(var e in L.setOptions(this,t),this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({options:{edit:{selectedPathOptions:{color:"#fe57a1",opacity:.6,dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1}},remove:{},featureGroup:null},initialize:function(t){t.edit&&(void 0===t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit=L.extend({},this.options.edit,t.edit)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},addToolbar:function(t){var e=L.DomUtil.create("div","leaflet-draw-section"),i=0,o="leaflet-draw-edit",n=this.options.featureGroup;return this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,this.options.edit&&this._initModeHandler(new L.EditToolbar.Edit(t,{featureGroup:n,selectedPathOptions:this.options.edit.selectedPathOptions}),this._toolbarContainer,i++,o,L.drawLocal.edit.toolbar.buttons.edit),this.options.remove&&this._initModeHandler(new L.EditToolbar.Delete(t,{featureGroup:n}),this._toolbarContainer,i++,o,L.drawLocal.edit.toolbar.buttons.remove),this._lastButtonIndex=--i,this._actionsContainer=this._createActions([{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]),e.appendChild(this._toolbarContainer),e.appendChild(this._actionsContainer),this._checkDisabled(),n.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){L.Toolbar.prototype.removeToolbar.call(this),this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=0!==this.options.featureGroup.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,e?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",e?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),this._selectedPathOptions=e.selectedPathOptions,this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this),this.fire("enabled",{handler:this.type}),this._map.fire("draw:editstart",{handler:this.type}))},disable:function(){this._enabled&&(this.fire("disabled",{handler:this.type}),this._map.fire("draw:editstop",{handler:this.type}),this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var e=new L.LayerGroup;this._featureGroup.eachLayer(function(t){t.edited&&(e.addLayer(t),t.edited=!1)}),this._map.fire("draw:edited",{layers:e})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(this._uneditedLayerProps[e]=t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?{latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?{latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:{latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())})},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):t.setLatLng(this._uneditedLayerProps[e].latlng))},_toggleMarkerHighlight:function(t){if(t._icon){var e=t._icon;e.style.display="none",L.DomUtil.hasClass(e,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,-4)):(L.DomUtil.addClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,4)),e.style.display=""}},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,o=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+"px",t.style.marginLeft=o+"px"},_enableLayerEdit:function(t){var e,i=t.layer||t.target||t,o=i instanceof L.Marker;o&&!i._icon||(this._backupLayer(i),this._selectedPathOptions&&(e=L.Util.extend({},this._selectedPathOptions),o?this._toggleMarkerHighlight(i):(i.options.previousOptions=i.options,i instanceof L.Circle||i instanceof L.Polygon||i instanceof L.Rectangle||(e.fill=!1),i.setStyle(e))),o?(i.dragging.enable(),i.on("dragend",this._onMarkerDragEnd)):i.editing.enable())},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this)):e.editing.disable()},_onMarkerDragEnd:function(t){t.target.edited=!0},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this),this.fire("enabled",{handler:this.type}),this._map.fire("draw:editstart",{handler:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),this.fire("disabled",{handler:this.type}),this._map.fire("draw:editstop",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.layerGroup,this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t)},this)},save:function(){this._map.fire("draw:deleted",{layers:this._deletedLayers})},_enableLayerDelete:function(t){(t.layer||t.target||t).on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e)},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(document),function(o,i){L.print=L.print||{},L.print.Provider=L.Class.extend({includes:L.Mixin.Events,statics:{MAX_RESOLUTION:156543.03390625,MAX_EXTENT:[-20037508.34,-20037508.34,20037508.34,20037508.34],SRS:"EPSG:3857",INCHES_PER_METER:39.3701,DPI:72,UNITS:"m"},options:{autoLoad:!1,autoOpen:!0,outputFormat:"pdf",outputFilename:"leaflet-map",method:"POST",rotation:0,customParams:{},legends:!1},initialize:function(t){if(L.version<="0.5.1")throw"Leaflet.print requires Leaflet 0.6.0+. Download latest from https://github.com/Leaflet/Leaflet/";var e;(t=L.setOptions(this,t)).map&&this.setMap(t.map),t.capabilities?this._capabilities=t.capabilities:this.options.autoLoad&&this.loadCapabilities(),t.listeners&&(t.listeners.context&&(e=t.listeners.context,delete t.listeners.context),this.addEventListener(t.listeners,e))},loadCapabilities:function(){var t;this.options.url&&(t=this.options.url+"/info.json",this.options.proxy&&(t=this.options.proxy+t),$.ajax({type:"GET",dataType:"json",url:t,success:L.Util.bind(this.onCapabilitiesLoad,this)}))},print:function(t){if(!(t=L.extend(L.extend({},this.options),t)).layout||!t.dpi)throw"Must provide a layout name and dpi value to print";this.fire("beforeprint",{provider:this,map:this._map});var e,i=JSON.stringify(L.extend({units:L.print.Provider.UNITS,srs:L.print.Provider.SRS,layout:t.layout,dpi:t.dpi,outputFormat:t.outputFormat,outputFilename:t.outputFilename,layers:this._encodeLayers(this._map),pages:[{center:this._projectCoords(L.print.Provider.SRS,this._map.getCenter()),scale:this._getScale(),rotation:t.rotation}]},this.options.customParams,t.customParams,this._makeLegends(this._map)));"GET"===t.method?(e=this._capabilities.printURL+"?spec="+encodeURIComponent(i),t.proxy&&(e=t.proxy+encodeURIComponent(e)),o.open(e),this.fire("print",{provider:this,map:this._map})):(e=this._capabilities.createURL,t.proxy&&(e=t.proxy+e),this._xhr&&this._xhr.abort(),this._xhr=$.ajax({type:"POST",contentType:"application/json; charset=UTF-8",processData:!1,dataType:"json",url:e,data:i,success:L.Util.bind(this.onPrintSuccess,this),error:L.Util.bind(this.onPrintError,this)}))},getCapabilities:function(){return this._capabilities},setMap:function(t){this._map=t},setDpi:function(t){this.options.dpi!==t&&(this.options.dpi=t,this.fire("dpichange",{provider:this,dpi:t}))},setLayout:function(t){this.options.layout!==t&&(this.options.layout=t,this.fire("layoutchange",{provider:this,layout:t}))},setRotation:function(t){this.options.rotation!==this.options.rotation&&(this.options.rotation=t,this.fire("rotationchange",{provider:this,rotation:t}))},_getLayers:function(t){var i,o,e,n,r=[],s=[],a=[],l=[];for(e in t._layers)if(t._layers.hasOwnProperty(e)){if(!t._layers.hasOwnProperty(e))continue;var h=t._layers[e];h instanceof L.TileLayer.WMS||h instanceof L.TileLayer?a.push(h):h instanceof L.ImageOverlay?l.push(h):h instanceof L.Marker?r.push(h):h instanceof L.Path&&h.toGeoJSON&&s.push(h)}for(r.sort(function(t,e){return t._icon.style.zIndex-e._icon.style.zIndex}),n=1;n<r.length;n++)r[n]._icon.style.zIndex<=r[n-1]._icon.style.zIndex&&(r[n]._icon.style.zIndex=r[n-1].icons.style.zIndex+1);for(a.sort(function(t,e){return t._container.style.zIndex-e._container.style.zIndex}),n=1;n<a.length;n++)a[n]._container.style.zIndex<=a[n-1]._container.style.zIndex&&(a[n]._container.style.zIndex=a[n-1]._container.style.zIndex+1);return i=[].slice.call(this,t._panes.overlayPane.childNodes),l.sort(function(t,e){return i.indexOf(t._image)-i.indexOf(e._image)}),t._pathRoot&&(o=[].slice.call(this,t._pathRoot.childNodes),s.sort(function(t,e){return o.indexOf(t._container)-o.indexOf(e._container)})),a.concat(s).concat(l).concat(r)},_getScale:function(){for(var t,e,i=this._map,o=i.getBounds(),n=1e3*L.print.Provider.INCHES_PER_METER,r=this._capabilities.scales,s=o.getSouthWest(),a=o.getNorthEast(),l=(s.lat+a.lat)/2,h=L.latLng(l,s.lng),c=L.latLng(l,a.lng),p=(h.distanceTo(c)/i.getSize().x/1e3||1e-6)*n*L.print.Provider.DPI,d=Number.POSITIVE_INFINITY,u=r.length;u--;)(t=Math.abs(p-Number(r[u].value)))<d&&(d=t,e=parseInt(Number(r[u].value),10));return e},_getLayoutByName:function(t){var e,i,o;for(i=0,o=this._capabilities.layouts.length;i<o;i++)if(this._capabilities.layouts[i].name===t){e=this._capabilities.layouts[i];break}return e},_encodeLayers:function(t){var e,i,o=[],n=[],r=this._getLayers(t);for(i=0;i<r.length;i++)(e=r[i])instanceof L.TileLayer.WMS?o.push(this._encoders.layers.tilelayerwms.call(this,e)):L.mapbox&&e instanceof L.mapbox.TileLayer?o.push(this._encoders.layers.tilelayermapbox.call(this,e)):e instanceof L.TileLayer?o.push(this._encoders.layers.tilelayer.call(this,e)):e instanceof L.ImageOverlay?o.push(this._encoders.layers.image.call(this,e)):(e instanceof L.Marker||e instanceof L.Path&&e.toGeoJSON)&&n.push(e);return n.length&&o.push(this._encoders.layers.vector.call(this,n)),o},_makeLegends:function(t,e){if(!this.options.legends)return[];var i,o,n,r,s,a,l=[],h=this._getLayers(t);for(r=0;r<h.length;r++)if((s=h[r])instanceof L.TileLayer.WMS){if(a={name:s.options.title||s.wmsParams.layers,classes:[]},i={SERVICE:"WMS",LAYER:s.wmsParams.layers,REQUEST:"GetLegendGraphic",VERSION:s.wmsParams.version,FORMAT:s.wmsParams.format,STYLE:s.wmsParams.styles,WIDTH:15,HEIGHT:15},i=L.extend(i,e),n=L.Util.template(s._url),1===(o=s.wmsParams.layers.split(",")).length)a.icons=[this._getAbsoluteUrl(n+L.Util.getParamString(i,n,!0))];else for(r=0;r<o.length;r++)i.LAYER=o[r],a.classes.push({name:o[r],icons:[this._getAbsoluteUrl(n+L.Util.getParamString(i,n,!0))]});l.push(a)}return{legends:l}},_encoders:{layers:{httprequest:function(t){var e=t._url;return-1!==e.indexOf("{s}")&&(e=e.replace("{s}",t.options.subdomains[0])),{baseURL:e=this._getAbsoluteUrl(e),opacity:t.options.opacity}},tilelayer:function(t){var e,i=this._encoders.layers.httprequest.call(this,t),o=t._url.substring(0,t._url.indexOf("{z}")),n=[];for(-1!==o.indexOf("{s}")&&(o=o.replace("{s}",t.options.subdomains[0])),e=0;e<=t.options.maxZoom;++e)n.push(L.print.Provider.MAX_RESOLUTION/Math.pow(2,e));return L.extend(i,{type:"OSM",baseURL:o,extension:"png",tileSize:[t.options.tileSize,t.options.tileSize],maxExtent:L.print.Provider.MAX_EXTENT,resolutions:n,singleTile:!1})},tilelayerwms:function(t){var e,i=this._encoders.layers.httprequest.call(this,t),o=t.options;for(e in L.extend(i,{type:"WMS",layers:[o.layers].join(",").split(",").filter(function(t){return""!==t}),format:o.format,styles:[o.styles].join(",").split(",").filter(function(t){return""!==t}),singleTile:!0}),t.wmsParams)t.wmsParams.hasOwnProperty(e)&&-1==="detectretina,format,height,layers,request,service,srs,styles,version,width".indexOf(e.toLowerCase())&&(i.customParams||(i.customParams={}),i.customParams[e]=t.wmsParams[e]);return i},tilelayermapbox:function(t){var e,i=[];for(e=0;e<=t.options.maxZoom;++e)i.push(L.print.Provider.MAX_RESOLUTION/Math.pow(2,e));var o={};return"string"==typeof t.options.access_token&&0<t.options.access_token.length&&(o.access_token=t.options.access_token),{type:"OSM",baseURL:t.options.tiles[0].substring(0,t.options.tiles[0].indexOf("{z}")),opacity:t.options.opacity,extension:"png",tileSize:[t.options.tileSize,t.options.tileSize],maxExtent:L.print.Provider.MAX_EXTENT,resolutions:i,singleTile:!1,customParams:o}},image:function(t){return{type:"Image",opacity:t.options.opacity,name:"image",baseURL:this._getAbsoluteUrl(t._url),extent:this._projectBounds(L.print.Provider.SRS,t._bounds)}},vector:function(t){var e,i,o,n,r,s,a,l,h=[],c={},p={},d={},u=1;for(a=0,l=t.length;a<l;a++){if((i=t[a])instanceof L.Marker){var _=i.options.icon,f=_.options.iconUrl||L.Icon.Default.imagePath+"/marker-icon.png",m=L.Util.isArray(_.options.iconSize)?new L.Point(_.options.iconSize[0],_.options.iconSize[1]):_.options.iconSize,g=L.Util.isArray(_.options.iconAnchor)?new L.Point(_.options.iconAnchor[0],_.options.iconAnchor[1]):_.options.iconAnchor,y=this.options.dpi/L.print.Provider.DPI;o={externalGraphic:this._getAbsoluteUrl(f),graphicWidth:m.x/y,graphicHeight:m.y/y,graphicXOffset:-g.x/y,graphicYOffset:-g.y/y}}else o=this._extractFeatureStyle(i);(p=d[n=JSON.stringify(o)])?r=p:(d[n]=r=u++,c[r]=o),(s=i instanceof L.Circle?this._circleGeoJSON(i):i.toGeoJSON()).geometry.coordinates=this._projectCoords(L.print.Provider.SRS,s.geometry.coordinates),s.properties._leaflet_style=r,null===e&&(e=i.options.opacity||1),h.push(s)}return{type:"Vector",styles:c,opacity:e,styleProperty:"_leaflet_style",geoJson:{type:"FeatureCollection",features:h}}}}},_circleGeoJSON:function(t){var e,i=t._map.options.crs.projection,o=1;i===L.Projection.SphericalMercator?o=6378137:i===L.Projection.Mercator&&(o=i.R_MAJOR);var n=i.project(t.getLatLng()),r=1/Math.cos(t.getLatLng().lat*Math.PI/180),s=[];for(e=0;e<64;e++){var a=2*e*Math.PI/64,l=L.point(Math.cos(a),Math.sin(a));s.push(i.unproject(n.add(l.multiplyBy(t.getRadius()*r/o))))}return L.polygon(s).toGeoJSON()},_extractFeatureStyle:function(t){var e=t.options;return{stroke:e.stroke,strokeColor:e.color,strokeWidth:e.weight,strokeOpacity:e.opacity,strokeLinecap:"round",fill:e.fill,fillColor:e.fillColor||e.color,fillOpacity:e.fillOpacity}},_getAbsoluteUrl:function(t){var e;return L.Browser.ie?((e=i.createElement("a")).style.display="none",i.body.appendChild(e),e.href=t,i.body.removeChild(e)):(e=i.createElement("a")).href=t,e.href},_projectBounds:function(t,e){var i=e.getSouthWest(),o=e.getNorthEast();return this._projectCoords(t,i).concat(this._projectCoords(t,o))},_projectCoords:function(t,e){var i=t.toUpperCase().replace(":",""),o=L.CRS[i];if(!o)throw"Unsupported coordinate reference system: "+t;return this._project(o,e)},_project:function(t,e){var i,o,n,r;if("number"==typeof e[0]&&(e=new L.LatLng(e[1],e[0])),e instanceof L.LatLng)return[(o=t.project(e)).x,o.y];for(i=[],n=0,r=e.length;n<r;n++)i.push(this._project(t,e[n]));return i},onCapabilitiesLoad:function(t){this._capabilities=t,this.options.layout||(this.options.layout=this._capabilities.layouts[0].name),this.options.dpi||(this.options.dpi=this._capabilities.dpis[0].value),this.fire("capabilitiesload",{provider:this,capabilities:this._capabilities})},onPrintSuccess:function(t){var e=t.getURL+(L.Browser.ie?"?inline=true":"");this.options.autoOpen&&(L.Browser.ie?o.open(e):o.location.href=e),this._xhr=null,this.fire("print",{provider:this,response:t})},onPrintError:function(t){this._xhr=null,this.fire("printexception",{provider:this,response:t})}}),L.print.provider=function(t){return new L.print.Provider(t)},L.Control.Print=L.Control.extend({options:{position:"topleft",showLayouts:!0},initialize:function(t){L.Control.prototype.initialize.call(this,t),this._actionButtons={},this._actionsVisible=!1,this.options.provider&&this.options.provider instanceof L.print.Provider?this._provider=this.options.provider:this._provider=L.print.Provider(this.options.provider||{})},onAdd:function(t){var e,i,o=L.DomUtil.create("div","leaflet-control-print"),n=L.DomUtil.create("div","leaflet-bar",o);return this._toolbarContainer=n,(i=L.DomUtil.create("a","leaflet-print-print",n)).href="#",i.title="Print map",L.DomEvent.on(i,"click",L.DomEvent.stopPropagation).on(i,"mousedown",L.DomEvent.stopPropagation).on(i,"dblclick",L.DomEvent.stopPropagation).on(i,"click",L.DomEvent.preventDefault).on(i,"click",this.onPrint,this),this.options.showLayouts&&((e=this._provider.getCapabilities())?this._createActions(o,e):this._provider.once("capabilitiesload",this.onCapabilitiesLoad,this)),this._provider.setMap(t),o},onRemove:function(){var t,e;for(t in this._actionButtons)this._actionButtons.hasOwnProperty(t)&&(e=this._actionButtons[t],this._disposeButton(e.button,e.callback,e.scope));this._actionButtons={},this._actionsContainer=null},getProvider:function(){return this._provider},_createActions:function(t,e){var i,o,n,r=e.layouts,s=r.length,a=L.DomUtil.create("ul","leaflet-print-actions",t),l=100*s+(s-1);for(a.style.width=l+"px",n=0;n<s;n++)o=L.DomUtil.create("li","",a),i=this._createButton({title:"Print map using the "+r[n].name+" layout",text:this._ellipsis(r[n].name,16),container:o,callback:this.onActionClick,context:this}),this._actionButtons[L.stamp(i)]={name:r[n].name,button:i,callback:this.onActionClick,context:this};this._actionsContainer=a},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container);return e.href="#",t.text&&(e.innerHTML=t.text),t.title&&(e.title=t.title),L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,"click",t.callback,t.context),e},_showActionsToolbar:function(){this._actionsContainer&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-print-actions-visible"),this._actionsContainer.style.display="block",this._actionsVisible=!0)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-print-actions-visible"),this._actionsVisible=!1},_ellipsis:function(t,e){return t&&t.length>e&&(t=t.substr(0,e-3)+"..."),t},onCapabilitiesLoad:function(t){this._createActions(this._container,t.capabilities)},onActionClick:function(t){var e,i,o=""+L.stamp(t.target);for(i in this._actionButtons)if(this._actionButtons.hasOwnProperty(i)&&i===o){e=this._actionButtons[i],this._provider.print({layout:e.name});break}this._hideActionsToolbar()},onPrint:function(){this.options.showLayouts?this._actionsVisible?this._hideActionsToolbar():this._showActionsToolbar():this._provider.print()}}),L.control.print=function(t){return new L.Control.Print(t)}}(this,document),function(t){if("function"==typeof define&&define.amd)define(["leaflet"],t);else if("undefined"!=typeof module)module.exports=t(require("leaflet"));else{if(void 0===window.L)throw"Leaflet must be loaded first";t(window.L)}}(function(c){return c.Control.PanelLayers=c.Control.Layers.extend({includes:"1"===c.version[0]?c.Evented.prototype:c.Mixin.Events,options:{compact:!1,compactOffset:0,collapsed:!1,autoZIndex:!0,collapsibleGroups:!1,buildItem:null,title:"",className:"",position:"topright"},initialize:function(t,e,i){var o,n,r;for(o in c.setOptions(this,i),this._layers=[],this._groups={},this._items={},this._layersActives=[],this._lastZIndex=0,this._handlingClick=!1,this.className="leaflet-panel-layers",t)if(t[o].group&&t[o].layers)for(n in r=t[o].collapsed||!1,t[o].layers)this._addLayer(t[o].layers[n],!1,t[o].group,r);else this._addLayer(t[o],!1);for(o in e)if(e[o].group&&e[o].layers)for(n in r=e[o].collapsed||!1,e[o].layers)this._addLayer(e[o].layers[n],!0,e[o].group,r);else this._addLayer(e[o],!0)},onAdd:function(t){var e=this;for(var i in this._layersActives)t.addLayer(this._layersActives[i]);return c.Control.Layers.prototype.onAdd.call(this,t),this._map.on("resize",function(t){e._updateHeight(t.newSize.y)}),this._container},addBaseLayer:function(t,e,i){return t.name=e||t.name||"",this._addLayer(t,!1,i),this._update(),this},addOverlay:function(t,e,i){return t.name=e||t.name||"",this._addLayer(t,!0,i),this._update(),this},removeLayer:function(t){var e=t.hasOwnProperty("layer")?this._layerFromDef(t):t;return this._map.removeLayer(e),c.Control.Layers.prototype.removeLayer.call(this,e),this},clearLayers:function(){for(var t=0;t<this._layers.length;t++)this.removeLayer(this._layers[t])},_layerFromDef:function(t){for(var e=0;e<this._layers.length;e++){var i=c.stamp(this._layers[e].layer);if(this._getLayer(i).name===t.name)return this._getLayer(i).layer}},_update:function(){this._groups={},this._items={},c.Control.Layers.prototype._update.call(this)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&this._layers[e].id==t)return this._layers[e]},_addLayer:function(t,e,i,o){if(!t.layer)throw new Error("layer not defined in item: "+(t.name||""));t.layer instanceof c.Class||!t.layer.type||!t.layer.args||(t.layer=this._getPath(c,t.layer.type).apply(c,t.layer.args)),t.hasOwnProperty("id")||(t.id=c.stamp(t.layer)),t.active&&this._layersActives.push(t.layer),this._layers.push(c.Util.extend(t,{collapsed:o,overlay:e,group:i})),this.options.autoZIndex&&t.layer&&t.layer.setZIndex&&(this._lastZIndex++,t.layer.setZIndex(this._lastZIndex))},_createItem:function(t){var e,i,o,n=this;e=c.DomUtil.create("div",this.className+"-item"+(t.active?" active":"")),o=this._map.hasLayer(t.layer),t.overlay?((i=c.DomUtil.create("input",this.className+"-selector")).type="checkbox",i.defaultChecked=o):i=this._createRadioElement("leaflet-base-layers",o,t),i.value=t.id,i.layerId=t.id,i.id=t.id,i._layer=t,c.DomEvent.on(i,"click",function(t){n._onInputClick(),t.target.checked?n.fire("panel:selected",t.target._layer):n.fire("panel:unselected",t.target._layer)},this);var r=c.DomUtil.create("label",this.className+"-title"),s=c.DomUtil.create("span");if(s.innerHTML=t.name||"",t.icon){var a=c.DomUtil.create("i",this.className+"-icon");"string"==typeof t.icon?a.innerHTML=t.icon||"":a.appendChild(t.icon),r.appendChild(a)}if(r.appendChild(i),r.appendChild(s),e.appendChild(r),this.options.buildItem){var l=this.options.buildItem.call(this,t);if("string"==typeof l){var h=c.DomUtil.create("div");h.innerHTML=l,e.appendChild(h.firstChild)}else e.appendChild(l)}return this._items[i.value]=e},_createRadioElement:function(t,e,i){var o='<input type="radio" class="'+this.className+'-selector" name="'+t+'" id="'+i.id+'"';e&&(o+=' checked="checked"'),o+=" />";var n=document.createElement("div");return n.innerHTML=o,n.firstChild},_addItem:function(t){var e,i=t.overlay?this._overlaysList:this._baseLayersList;if(t.group){if(t.group.hasOwnProperty("name")||(t.group={name:t.group}),!this._groups[t.group.name]){var o=!1;!0===t.collapsed&&(o=!0),this._groups[t.group.name]=this._createGroup(t.group,o)}i.appendChild(this._groups[t.group.name]),i=this._groups[t.group.name]}return e=this._createItem(t),i.appendChild(e),e},_createGroup:function(t,e){var i,o,n=this,r=c.DomUtil.create("div",this.className+"-group");return this.options.collapsibleGroups&&(c.DomUtil.addClass(r,"collapsible"),(o=c.DomUtil.create("i",this.className+"-icon",r)).innerHTML=!0===e?" + ":" - ",c.DomEvent.on(o,"click",function(){c.DomUtil.hasClass(r,"expanded")?(c.DomUtil.removeClass(r,"expanded"),o.innerHTML=" + "):(c.DomUtil.addClass(r,"expanded"),o.innerHTML=" - "),n._updateHeight()}),!1===e&&c.DomUtil.addClass(r,"expanded")),i=c.DomUtil.create("label",this.className+"-grouplabel",r),c.DomUtil.create("span",this.className+"-title",i).innerHTML=t.name,r},_onInputClick:function(){var t,e,i,o=this._form.getElementsByClassName(this.className+"-selector"),n=o.length;for(this._handlingClick=!0,t=0;t<n;t++)e=o[t],i=this._getLayer(e.value),e.checked&&!this._map.hasLayer(i.layer)?(c.DomUtil.addClass(e.parentNode.parentNode,"active"),this._map.addLayer(i.layer)):!e.checked&&this._map.hasLayer(i.layer)&&(c.DomUtil.removeClass(e.parentNode.parentNode,"active"),this._map.removeLayer(i.layer));this._handlingClick=!1,this._refocusOnMap()},_initLayout:function(){var t=this._container=c.DomUtil.create("div",this.className);if(this.options.compact&&c.DomUtil.addClass(t,"compact"),t.setAttribute("aria-haspopup",!0),c.DomEvent.disableClickPropagation(t).disableScrollPropagation(t),this.options.className&&c.DomUtil.addClass(t,this.options.className),this._section=this._form=c.DomUtil.create("form",this.className+"-list"),this._updateHeight(),this.options.collapsed?(c.Browser.android?c.DomEvent.on(t,"click",this._expand,this):c.DomEvent.on(t,"mouseenter",this._expand,this).on(t,"mouseleave",this._collapse,this),this._map.on("click",this._collapse,this)):this._expand(),this._baseLayersList=c.DomUtil.create("div",this.className+"-base",this._form),this._separator=c.DomUtil.create("div",this.className+"-separator",this._form),this._overlaysList=c.DomUtil.create("div",this.className+"-overlays",this._form),this.options.title){var e=c.DomUtil.create("label",this.className+"-title");e.innerHTML="<span>"+this.options.title+"</span>",t.appendChild(e)}t.appendChild(this._form)},_updateHeight:function(t){t=t||this._map.getSize().y,this.options.compact?this._form.style.maxHeight=t-this.options.compactOffset+"px":this._form.style.height=t+"px"},_expand:function(){c.DomUtil.addClass(this._container,"expanded")},_collapse:function(){this._container.className=this._container.className.replace("expanded","")},_getPath:function(t,e){var i=e.split("."),o=i.pop(),n=i.length,r=i[0],s=1;if(0<n)for(;(t=t[r])&&s<n;)r=i[s++];return t?t[o]:void 0}}),c.control.panelLayers=function(t,e,i){return new c.Control.PanelLayers(t,e,i)},c.Control.PanelLayers}),function(t){if("function"==typeof define&&define.amd)define(["leaflet"],t);else if("undefined"!=typeof module)module.exports=t(require("leaflet"));else{if(void 0===window.L)throw"Leaflet must be loaded first";t(window.L)}}(function(r){return r.Control.Search=r.Control.extend({includes:"1"===r.version[0]?r.Evented.prototype:r.Mixin.Events,options:{url:"",layer:null,sourceData:null,jsonpParam:null,propertyLoc:"loc",propertyName:"title",formatData:null,filterData:null,moveToLocation:null,buildTip:null,container:"",zoom:null,minLength:1,initial:!0,casesensitive:!1,autoType:!0,delayType:400,tooltipLimit:-1,tipAutoSubmit:!0,firstTipSubmit:!1,autoResize:!0,collapsed:!0,autoCollapse:!1,autoCollapseTime:1200,textErr:"Location not found",textCancel:"Cancel",textPlaceholder:"Search...",hideMarkerOnCollapse:!1,position:"topleft",marker:{icon:!1,animate:!0,circle:{radius:10,weight:3,color:"#e03",stroke:!0,fill:!1}}},_getPath:function(t,e){var i=e.split("."),o=i.pop(),n=i.length,r=i[0],s=1;if(0<n)for(;(t=t[r])&&s<n;)r=i[s++];if(t)return t[o]},_isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},initialize:function(t){r.Util.setOptions(this,t||{}),this._inputMinSize=this.options.textPlaceholder?this.options.textPlaceholder.length:10,this._layer=this.options.layer||new r.LayerGroup,this._filterData=this.options.filterData||this._defaultFilterData,this._formatData=this.options.formatData||this._defaultFormatData,this._moveToLocation=this.options.moveToLocation||this._defaultMoveToLocation,this._autoTypeTmp=this.options.autoType,this._countertips=0,this._recordsCache={},this._curReq=null},onAdd:function(t){return this._map=t,this._container=r.DomUtil.create("div","leaflet-control-search"),this._input=this._createInput(this.options.textPlaceholder,"search-input"),this._tooltip=this._createTooltip("search-tooltip"),this._cancel=this._createCancel(this.options.textCancel,"search-cancel"),this._button=this._createButton(this.options.textPlaceholder,"search-button"),this._alert=this._createAlert("search-alert"),!1===this.options.collapsed&&this.expand(this.options.collapsed),this.options.marker&&(this.options.marker instanceof r.Marker||this.options.marker instanceof r.CircleMarker?this._markerSearch=this.options.marker:this._isObject(this.options.marker)&&(this._markerSearch=new r.Control.Search.Marker([0,0],this.options.marker)),this._markerSearch._isMarkerSearch=!0),this.setLayer(this._layer),t.on({resize:this._handleAutoresize},this),this._container},addTo:function(t){return this.options.container?(this._container=this.onAdd(t),this._wrapper=r.DomUtil.get(this.options.container),this._wrapper.style.position="relative",this._wrapper.appendChild(this._container)):r.Control.prototype.addTo.call(this,t),this},onRemove:function(t){this._recordsCache={},t.off({resize:this._handleAutoresize},this)},setLayer:function(t){return this._layer=t,this._layer.addTo(this._map),this},showAlert:function(t){var e=this;return t=t||this.options.textErr,this._alert.style.display="block",this._alert.innerHTML=t,clearTimeout(this.timerAlert),this.timerAlert=setTimeout(function(){e.hideAlert()},this.options.autoCollapseTime),this},hideAlert:function(){return this._alert.style.display="none",this},cancel:function(){return this._input.value="",this._handleKeypress({keyCode:8}),this._input.size=this._inputMinSize,this._input.focus(),this._cancel.style.display="none",this._hideTooltip(),this.fire("search:cancel"),this},expand:function(t){return t="boolean"!=typeof t||t,this._input.style.display="block",r.DomUtil.addClass(this._container,"search-exp"),!1!==t&&(this._input.focus(),this._map.on("dragstart click",this.collapse,this)),this.fire("search:expanded"),this},collapse:function(){return this._hideTooltip(),this.cancel(),this._alert.style.display="none",this._input.blur(),this.options.collapsed&&(this._input.style.display="none",this._cancel.style.display="none",r.DomUtil.removeClass(this._container,"search-exp"),this.options.hideMarkerOnCollapse&&this._map.removeLayer(this._markerSearch),this._map.off("dragstart click",this.collapse,this)),this.fire("search:collapsed"),this},collapseDelayed:function(){var t=this;return this.options.autoCollapse&&(clearTimeout(this.timerCollapse),this.timerCollapse=setTimeout(function(){t.collapse()},this.options.autoCollapseTime)),this},collapseDelayedStop:function(){return clearTimeout(this.timerCollapse),this},_createAlert:function(t){var e=r.DomUtil.create("div",t,this._container);return e.style.display="none",r.DomEvent.on(e,"click",r.DomEvent.stop,this).on(e,"click",this.hideAlert,this),e},_createInput:function(t,e){var i=this,o=r.DomUtil.create("label",e,this._container),n=r.DomUtil.create("input",e,this._container);return n.type="text",n.size=this._inputMinSize,n.value="",n.autocomplete="off",n.autocorrect="off",n.autocapitalize="off",n.placeholder=t,n.style.display="none",n.role="search",n.id=n.role+n.type+n.size,o.htmlFor=n.id,o.style.display="none",o.value=t,r.DomEvent.disableClickPropagation(n).on(n,"keyup",this._handleKeypress,this).on(n,"paste",function(t){setTimeout(function(t){i._handleKeypress(t)},10,t)},this).on(n,"blur",this.collapseDelayed,this).on(n,"focus",this.collapseDelayedStop,this),n},_createCancel:function(t,e){var i=r.DomUtil.create("a",e,this._container);return i.href="#",i.title=t,i.style.display="none",i.innerHTML="<span>&otimes;</span>",r.DomEvent.on(i,"click",r.DomEvent.stop,this).on(i,"click",this.cancel,this),i},_createButton:function(t,e){var i=r.DomUtil.create("a",e,this._container);return i.href="#",i.title=t,r.DomEvent.on(i,"click",r.DomEvent.stop,this).on(i,"click",this._handleSubmit,this).on(i,"focus",this.collapseDelayedStop,this).on(i,"blur",this.collapseDelayed,this),i},_createTooltip:function(t){var e=this,i=r.DomUtil.create("ul",t,this._container);return i.style.display="none",r.DomEvent.disableClickPropagation(i).on(i,"blur",this.collapseDelayed,this).on(i,"mousewheel",function(t){e.collapseDelayedStop(),r.DomEvent.stopPropagation(t)},this).on(i,"mouseover",function(t){e.collapseDelayedStop()},this),i},_createTip:function(e,t){var i;if(this.options.buildTip){if("string"==typeof(i=this.options.buildTip.call(this,e,t))){var o=r.DomUtil.create("div");o.innerHTML=i,i=o.firstChild}}else(i=r.DomUtil.create("li","")).innerHTML=e;return r.DomUtil.addClass(i,"search-tip"),i._text=e,this.options.tipAutoSubmit&&r.DomEvent.disableClickPropagation(i).on(i,"click",r.DomEvent.stop,this).on(i,"click",function(t){this._input.value=e,this._handleAutoresize(),this._input.focus(),this._hideTooltip(),this._handleSubmit()},this),i},_getUrl:function(t){return"function"==typeof this.options.url?this.options.url(t):this.options.url},_defaultFilterData:function(t,e){var i,o,n,r={};if(""===(t=t.replace(/[.*+?^${}()|[\]\\]/g,"")))return[];for(var s in i=this.options.initial?"^":"",o=this.options.casesensitive?void 0:"i",n=new RegExp(i+t,o),e)n.test(s)&&(r[s]=e[s]);return r},showTooltip:function(t){if(this._countertips=0,this._tooltip.innerHTML="",this._tooltip.currentSelection=-1,this.options.tooltipLimit)for(var e in t){if(this._countertips===this.options.tooltipLimit)break;this._countertips++,this._tooltip.appendChild(this._createTip(e,t[e]))}return 0<this._countertips?(this._tooltip.style.display="block",this._autoTypeTmp&&this._autoType(),this._autoTypeTmp=this.options.autoType):this._hideTooltip(),this._tooltip.scrollTop=0,this._countertips},_hideTooltip:function(){return this._tooltip.style.display="none",this._tooltip.innerHTML="",0},_defaultFormatData:function(t){var e,i=this.options.propertyName,o=this.options.propertyLoc,n={};if(r.Util.isArray(o))for(e in t)n[this._getPath(t[e],i)]=r.latLng(t[e][o[0]],t[e][o[1]]);else for(e in t)n[this._getPath(t[e],i)]=r.latLng(this._getPath(t[e],o));return n},_recordsFromJsonp:function(t,e){r.Control.Search.callJsonp=e;var i=r.DomUtil.create("script","leaflet-search-jsonp",document.getElementsByTagName("body")[0]),o=r.Util.template(this._getUrl(t)+"&"+this.options.jsonpParam+"=L.Control.Search.callJsonp",{s:t});return i.type="text/javascript",i.src=o,{abort:function(){i.parentNode.removeChild(i)}}},_recordsFromAjax:function(t,e){void 0===window.XMLHttpRequest&&(window.XMLHttpRequest=function(){try{return new ActiveXObject("Microsoft.XMLHTTP.6.0")}catch(t){try{return new ActiveXObject("Microsoft.XMLHTTP.3.0")}catch(t){throw new Error("XMLHttpRequest is not supported")}}});var i=new(r.Browser.ie&&!window.atob&&document.querySelector?XDomainRequest:XMLHttpRequest),o=r.Util.template(this._getUrl(t),{s:t});return i.open("GET",o),i.onload=function(){e(JSON.parse(i.responseText))},i.onreadystatechange=function(){4===i.readyState&&200===i.status&&this.onload()},i.send(),i},_searchInLayer:function(t,e,i){var o,n=this;t instanceof r.Control.Search.Marker||(t instanceof r.Marker||t instanceof r.CircleMarker?n._getPath(t.options,i)?((o=t.getLatLng()).layer=t,e[n._getPath(t.options,i)]=o):n._getPath(t.feature.properties,i)?((o=t.getLatLng()).layer=t,e[n._getPath(t.feature.properties,i)]=o):console.warn("propertyName '"+i+"' not found in marker"):t instanceof r.Path||t instanceof r.Polyline||t instanceof r.Polygon?n._getPath(t.options,i)?((o=t.getBounds().getCenter()).layer=t,e[n._getPath(t.options,i)]=o):n._getPath(t.feature.properties,i)?((o=t.getBounds().getCenter()).layer=t,e[n._getPath(t.feature.properties,i)]=o):console.warn("propertyName '"+i+"' not found in shape"):t.hasOwnProperty("feature")?t.feature.properties.hasOwnProperty(i)?t.getLatLng&&"function"==typeof t.getLatLng?((o=t.getLatLng()).layer=t,e[t.feature.properties[i]]=o):t.getBounds&&"function"==typeof t.getBounds?((o=t.getBounds().getCenter()).layer=t,e[t.feature.properties[i]]=o):console.warn("Unknown type of Layer"):console.warn("propertyName '"+i+"' not found in feature"):t instanceof r.LayerGroup&&t.eachLayer(function(t){n._searchInLayer(t,e,i)}))},_recordsFromLayer:function(){var e=this,i={},o=this.options.propertyName;return this._layer.eachLayer(function(t){e._searchInLayer(t,i,o)}),i},_autoType:function(){var t=this._input.value.length,e=this._tooltip.firstChild?this._tooltip.firstChild._text:"",i=e.length;if(0===e.indexOf(this._input.value))if(this._input.value=e,this._handleAutoresize(),this._input.createTextRange){var o=this._input.createTextRange();o.collapse(!0),o.moveStart("character",t),o.moveEnd("character",i),o.select()}else this._input.setSelectionRange?this._input.setSelectionRange(t,i):this._input.selectionStart&&(this._input.selectionStart=t,this._input.selectionEnd=i)},_hideAutoType:function(){var t;if((t=this._input.selection)&&t.empty)t.empty();else if(this._input.createTextRange){(t=this._input.createTextRange()).collapse(!0);var e=this._input.value.length;t.moveStart("character",e),t.moveEnd("character",e),t.select()}else this._input.getSelection&&this._input.getSelection().removeAllRanges(),this._input.selectionStart=this._input.selectionEnd},_handleKeypress:function(t){var e=this;switch(t.keyCode){case 27:this.collapse();break;case 13:(1==this._countertips||this.options.firstTipSubmit&&0<this._countertips)&&-1==this._tooltip.currentSelection&&this._handleArrowSelect(1),this._handleSubmit();break;case 38:this._handleArrowSelect(-1);break;case 40:this._handleArrowSelect(1);break;case 8:case 45:case 46:this._autoTypeTmp=!1;break;case 37:case 39:case 16:case 17:case 35:case 36:break;default:this._input.value.length?this._cancel.style.display="block":this._cancel.style.display="none",this._input.value.length>=this.options.minLength?(clearTimeout(this.timerKeypress),this.timerKeypress=setTimeout(function(){e._fillRecordsCache()},this.options.delayType)):this._hideTooltip()}this._handleAutoresize()},searchText:function(t){var e=t.charCodeAt(t.length);this._input.value=t,this._input.style.display="block",r.DomUtil.addClass(this._container,"search-exp"),this._autoTypeTmp=!1,this._handleKeypress({keyCode:e})},_fillRecordsCache:function(){var e,i=this,t=this._input.value;this._curReq&&this._curReq.abort&&this._curReq.abort(),r.DomUtil.addClass(this._container,"search-load"),this.options.layer?(this._recordsCache=this._recordsFromLayer(),e=this._filterData(this._input.value,this._recordsCache),this.showTooltip(e),r.DomUtil.removeClass(this._container,"search-load")):(this.options.sourceData?this._retrieveData=this.options.sourceData:this.options.url&&(this._retrieveData=this.options.jsonpParam?this._recordsFromJsonp:this._recordsFromAjax),this._curReq=this._retrieveData.call(this,t,function(t){i._recordsCache=i._formatData.call(i,t),e=i.options.sourceData?i._filterData(i._input.value,i._recordsCache):i._recordsCache,i.showTooltip(e),r.DomUtil.removeClass(i._container,"search-load")}))},_handleAutoresize:function(){var t;this._input.style.maxWidth!==this._map._container.offsetWidth&&(t=this._map._container.clientWidth,t-=83,this._input.style.maxWidth=t.toString()+"px"),this.options.autoResize&&this._container.offsetWidth+20<this._map._container.offsetWidth&&(this._input.size=this._input.value.length<this._inputMinSize?this._inputMinSize:this._input.value.length)},_handleArrowSelect:function(t){var e=this._tooltip.hasChildNodes()?this._tooltip.childNodes:[];for(i=0;i<e.length;i++)r.DomUtil.removeClass(e[i],"search-tip-select");if(1==t&&this._tooltip.currentSelection>=e.length-1)r.DomUtil.addClass(e[this._tooltip.currentSelection],"search-tip-select");else if(-1==t&&this._tooltip.currentSelection<=0)this._tooltip.currentSelection=-1;else if("none"!=this._tooltip.style.display){this._tooltip.currentSelection+=t,r.DomUtil.addClass(e[this._tooltip.currentSelection],"search-tip-select"),this._input.value=e[this._tooltip.currentSelection]._text;var o=e[this._tooltip.currentSelection].offsetTop;o+e[this._tooltip.currentSelection].clientHeight>=this._tooltip.scrollTop+this._tooltip.clientHeight?this._tooltip.scrollTop=o-this._tooltip.clientHeight+e[this._tooltip.currentSelection].clientHeight:o<=this._tooltip.scrollTop&&(this._tooltip.scrollTop=o)}},_handleSubmit:function(){if(this._hideAutoType(),this.hideAlert(),this._hideTooltip(),"none"==this._input.style.display)this.expand();else if(""===this._input.value)this.collapse();else{var t=this._getLocation(this._input.value);!1===t?this.showAlert():(this.showLocation(t,this._input.value),this.fire("search:locationfound",{latlng:t,text:this._input.value,layer:t.layer?t.layer:null}))}},_getLocation:function(t){return!!this._recordsCache.hasOwnProperty(t)&&this._recordsCache[t]},_defaultMoveToLocation:function(t,e,i){this.options.zoom?this._map.setView(t,this.options.zoom):this._map.panTo(t)},showLocation:function(e,t){var i=this;return i._map.once("moveend zoomend",function(t){i._markerSearch&&i._markerSearch.addTo(i._map).setLatLng(e)}),i._moveToLocation(e,t,i._map),i.options.autoCollapse&&i.collapse(),i}}),r.Control.Search.Marker=r.Marker.extend({includes:"1"===r.version[0]?r.Evented.prototype:r.Mixin.Events,options:{icon:new r.Icon.Default,animate:!0,circle:{radius:10,weight:3,color:"#e03",stroke:!0,fill:!1}},initialize:function(t,e){r.setOptions(this,e),!0===e.icon&&(e.icon=new r.Icon.Default),r.Marker.prototype.initialize.call(this,t,e),r.Control.Search.prototype._isObject(this.options.circle)&&(this._circleLoc=new r.CircleMarker(t,this.options.circle))},onAdd:function(t){r.Marker.prototype.onAdd.call(this,t),this._circleLoc&&(t.addLayer(this._circleLoc),this.options.animate&&this.animate())},onRemove:function(t){r.Marker.prototype.onRemove.call(this,t),this._circleLoc&&t.removeLayer(this._circleLoc)},setLatLng:function(t){return r.Marker.prototype.setLatLng.call(this,t),this._circleLoc&&this._circleLoc.setLatLng(t),this},_initIcon:function(){this.options.icon&&r.Marker.prototype._initIcon.call(this)},_removeIcon:function(){this.options.icon&&r.Marker.prototype._removeIcon.call(this)},animate:function(){if(this._circleLoc){var t=this._circleLoc,e=parseInt(t._radius/5),i=this.options.circle.radius,o=2*t._radius,n=0;t._timerAnimLoc=setInterval(function(){o-=e+=n+=.5,t.setRadius(o),o<i&&(clearInterval(t._timerAnimLoc),t.setRadius(i))},200)}return this}}),r.Map.addInitHook(function(){this.options.searchControl&&(this.searchControl=r.control.search(this.options.searchControl),this.addControl(this.searchControl))}),r.control.search=function(t){return new r.Control.Search(t)},r.Control.Search});